{"version":3,"sources":["../../src/layout/match_layout.ts"],"names":["layouts","matchLayout","presentation","slide","layoutName","undefined","customLayout","layout","find","layoutProperties","displayName","name","match","Error","GenericLayout","defineLayout","matchFn","push","hasText","text","rawText","length","hasBigTitle","title","big","hasTextContent","bodies","hasContent","tables","subtitle"],"mappings":"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","sourcesContent":["// Copyright 2016 Google Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//    http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport GenericLayout from './generic_layout';\nimport { slides_v1 as SlidesV1 } from 'googleapis';\nimport { SlideDefinition, TextDefinition } from '../slides';\n\ntype MatchFn = (slide: SlideDefinition) => boolean;\n\ninterface Layout {\n    name: string;\n    match: MatchFn;\n}\n\nconst layouts: Layout[] = [];\n\nexport default function matchLayout(presentation: SlidesV1.Schema$Presentation, slide: SlideDefinition): GenericLayout {\n    // if we have manually set the slide layout get the master from the presentation\n    let layoutName: string = undefined;\n    if (slide.customLayout !== undefined) {\n        let layout = presentation.layouts.find(layout => layout.layoutProperties.displayName == slide.customLayout);\n        if (layout) {\n            layoutName = layout.layoutProperties.name;\n        }\n    }\n    if (layoutName == undefined) {\n        let layout = layouts.find(layout => layout.match(slide));\n        if (!layout) {\n            throw new Error('Failed to match layout for slide');\n        }\n        layoutName = layout.name;\n    }\n    return new GenericLayout(layoutName, presentation, slide);\n}\n\nfunction defineLayout(name: string, matchFn: MatchFn): void {\n    layouts.push({\n        name: name,\n        match: matchFn,\n    });\n}\n\nfunction hasText(text: TextDefinition): boolean {\n    return text && text.rawText && text.rawText.length !== 0;\n}\n\nfunction hasBigTitle(slide: SlideDefinition): boolean {\n    return hasText(slide.title) && slide.title.big;\n}\n\nfunction hasTextContent(slide: SlideDefinition): boolean {\n    return slide.bodies.length !== 0;\n}\n\n// Anything which takes up the main body space\nfunction hasContent(slide: SlideDefinition): boolean {\n    return slide.bodies.length !== 0 || slide.tables.length !== 0;\n}\n\n// Define rules for picking slide layouts based on the default\n// layouts in Slides.\n// NOTE: Order matters since first match wins.\n\ndefineLayout('TITLE', slide => hasText(slide.title) && hasText(slide.subtitle) && !hasContent(slide));\ndefineLayout('MAIN_POINT', slide => hasBigTitle(slide) && !hasContent(slide));\ndefineLayout('SECTION_HEADER', slide => hasText(slide.title) && !hasText(slide.subtitle) && !hasContent(slide));\ndefineLayout(\n    'SECTION_TITLE_AND_DESCRIPTION',\n    slide => hasText(slide.title) && hasText(slide.subtitle) && hasTextContent(slide),\n);\ndefineLayout('BIG_NUMBER', slide => hasBigTitle(slide) && hasTextContent(slide));\ndefineLayout('TITLE_AND_TWO_COLUMNS', slide => hasText(slide.title) && slide.bodies.length == 2);\ndefineLayout('TITLE_AND_BODY', slide => hasText(slide.title) || slide.bodies.length !== 0);\ndefineLayout('BLANK', () => true);\n"],"file":"match_layout.js"}