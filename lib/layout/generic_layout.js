"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _debug = _interopRequireDefault(require("debug"));

var _utils = require("../utils");

var _extend = _interopRequireDefault(require("extend"));

var _layout = _interopRequireDefault(require("layout"));

var _ = _interopRequireWildcard(require("lodash"));

var _presentation_helpers = require("./presentation_helpers");

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

const debug = (0, _debug.default)('md2gslides');

/**
 * Performs most of the work of converting a slide into API requests.
 *
 */
class GenericLayout {
  constructor(name, presentation, slide) {
    _defineProperty(this, "name", void 0);

    _defineProperty(this, "presentation", void 0);

    _defineProperty(this, "slide", void 0);

    this.name = name;
    this.presentation = presentation;
    this.slide = slide;
  }

  appendCreateSlideRequest(requests) {
    const layoutId = (0, _presentation_helpers.findLayoutIdByName)(this.presentation, this.name);

    if (!layoutId) {
      throw new Error(`Unable to find layout ${this.name}`);
    }

    this.slide.objectId = (0, _utils.uuid)();
    debug('Creating slide %s with layout %s', this.slide.objectId, this.name);
    requests.push({
      createSlide: {
        slideLayoutReference: {
          layoutId: layoutId
        },
        objectId: this.slide.objectId
      }
    });
    return requests;
  }

  appendContentRequests(requests) {
    this.appendFillPlaceholderTextRequest(this.slide.title, 'TITLE', requests);
    this.appendFillPlaceholderTextRequest(this.slide.title, 'CENTERED_TITLE', requests);
    this.appendFillPlaceholderTextRequest(this.slide.subtitle, 'SUBTITLE', requests);

    if (this.slide.backgroundImage) {
      this.appendSetBackgroundImageRequest(this.slide.backgroundImage, requests);
    }

    if (this.slide.tables.length) {
      this.appendCreateTableRequests(this.slide.tables, requests);
    }

    if (this.slide.bodies) {
      const bodyElements = (0, _presentation_helpers.findPlaceholder)(this.presentation, this.slide.objectId, 'BODY');
      this.slide.bodies.forEach((body, index) => {
        let placeholder = bodyElements[index];
        this.appendFillPlaceholderTextRequest(body.text, placeholder, requests);

        if (body.images && body.images.length) {
          this.appendCreateImageRequests(body.images, placeholder, requests);
        }

        if (body.videos && body.videos.length) {
          this.appendCreateVideoRequests(body.videos, placeholder, requests);
        }
      });
    }

    if (this.slide.notes) {
      const objectId = (0, _presentation_helpers.findSpeakerNotesObjectId)(this.presentation, this.slide.objectId);
      this.appendInsertTextRequests(this.slide.notes, {
        objectId: objectId
      }, requests);
    }

    return requests;
  }

  appendFillPlaceholderTextRequest(value, placeholder, requests) {
    if (!value) {
      debug('No text for placeholder %s');
      return;
    }

    if (typeof placeholder === 'string') {
      const pageElements = (0, _presentation_helpers.findPlaceholder)(this.presentation, this.slide.objectId, placeholder);

      if (!pageElements) {
        debug('Skipping undefined placeholder %s', placeholder);
        return;
      }

      placeholder = pageElements[0];
    }

    this.appendInsertTextRequests(value, {
      objectId: placeholder.objectId
    }, requests);
  }

  appendInsertTextRequests(text, locationProps, requests) {
    // Insert the raw text first
    let request = {
      insertText: (0, _extend.default)({
        text: text.rawText
      }, locationProps)
    };
    requests.push(request); // Apply any text styles present.
    // Most of the work for generating the text runs
    // is performed when parsing markdown.

    for (let textRun of text.textRuns) {
      let request = {
        updateTextStyle: (0, _extend.default)({
          textRange: {
            type: 'FIXED_RANGE',
            startIndex: textRun.start,
            endIndex: textRun.end
          },
          style: {
            bold: textRun.bold,
            italic: textRun.italic,
            foregroundColor: textRun.foregroundColor,
            backgroundColor: textRun.backgroundColor,
            strikethrough: textRun.strikethrough,
            underline: textRun.underline,
            smallCaps: textRun.smallCaps,
            fontFamily: textRun.fontFamily,
            fontSize: textRun.fontSize,
            link: textRun.link,
            baselineOffset: textRun.baselineOffset
          }
        }, locationProps)
      };
      request.updateTextStyle.fields = this.computeShallowFieldMask(request.updateTextStyle.style);

      if (request.updateTextStyle.fields.length) {
        requests.push(request); // Only push if at least one style set
      }
    } // Convert paragraphs to lists.
    // Note that leading tabs for nested lists in the raw text are removed.
    // In this case, we're assuming that lists are supplied in order of
    // appearance and they're non-overlapping.
    // Processing in the reverse order avoids having to readjust indices.


    for (let listMarker of _.reverse(text.listMarkers)) {
      let request = {
        createParagraphBullets: (0, _extend.default)({
          textRange: {
            type: 'FIXED_RANGE',
            startIndex: listMarker.start,
            endIndex: listMarker.end
          },
          bulletPreset: listMarker.type == 'ordered' ? 'NUMBERED_DIGIT_ALPHA_ROMAN' : 'BULLET_DISC_CIRCLE_SQUARE'
        }, locationProps)
      };
      requests.push(request);
    }
  }

  appendSetBackgroundImageRequest(image, requests) {
    debug('Slide #%d: setting background image to %s', this.slide.index, image.url);
    requests.push({
      updatePageProperties: {
        objectId: this.slide.objectId,
        fields: 'pageBackgroundFill.stretchedPictureFill.contentUrl',
        pageProperties: {
          pageBackgroundFill: {
            stretchedPictureFill: {
              contentUrl: image.url
            }
          }
        }
      }
    });
  }

  appendCreateImageRequests(images, placeholder, requests) {
    // TODO - Fix weird cast
    const layer = (0, _layout.default)('left-right'); // TODO - Configurable?

    for (let image of images) {
      debug('Slide #%d: adding inline image %s', this.slide.index, image.url);
      layer.addItem({
        width: image.width + image.padding * 2,
        height: image.height + image.padding * 2,
        meta: image
      });
    }

    const box = this.getBodyBoundingBox(placeholder);
    const computedLayout = layer.export();
    let scaleRatio = Math.min(box.width / computedLayout.width, box.height / computedLayout.height);
    let scaledWidth = computedLayout.width * scaleRatio;
    let scaledHeight = computedLayout.height * scaleRatio;
    let baseTranslateX = box.x + (box.width - scaledWidth) / 2;
    let baseTranslateY = box.y + (box.height - scaledHeight) / 2;

    for (let item of computedLayout.items) {
      let itemOffsetX = item.meta.offsetX ? item.meta.offsetX : 0;
      let itemOffsetY = item.meta.offsetY ? item.meta.offsetY : 0;
      let itemPadding = item.meta.padding ? item.meta.padding : 0;
      let width = item.meta.width * scaleRatio;
      let height = item.meta.height * scaleRatio;
      let translateX = baseTranslateX + (item.x + itemPadding + itemOffsetX) * scaleRatio;
      let translateY = baseTranslateY + (item.y + itemPadding + itemOffsetY) * scaleRatio;
      requests.push({
        createImage: {
          elementProperties: {
            pageObjectId: this.slide.objectId,
            size: {
              height: {
                magnitude: height,
                unit: 'EMU'
              },
              width: {
                magnitude: width,
                unit: 'EMU'
              }
            },
            transform: {
              scaleX: 1,
              scaleY: 1,
              translateX: translateX,
              translateY: translateY,
              shearX: 0,
              shearY: 0,
              unit: 'EMU'
            }
          },
          url: item.meta.url
        }
      });
    }
  }

  appendCreateVideoRequests(videos, placeholder, requests) {
    if (videos.length > 1) {
      throw new Error('Multiple videos per slide are not supported.');
    }

    const video = videos[0];
    debug('Slide #%d: adding video %s', this.slide.index, video.id);
    const box = this.getBodyBoundingBox(placeholder);
    const scaleRatio = Math.min(box.width / video.width, box.height / video.height);
    const scaledWidth = video.width * scaleRatio;
    const scaledHeight = video.height * scaleRatio;
    let translateX = box.x + (box.width - scaledWidth) / 2;
    let translateY = box.y + (box.height - scaledHeight) / 2;
    const objectId = (0, _utils.uuid)();
    requests.push({
      createVideo: {
        source: 'YOUTUBE',
        objectId: objectId,
        id: video.id,
        elementProperties: {
          pageObjectId: this.slide.objectId,
          size: {
            height: {
              magnitude: scaledHeight,
              unit: 'EMU'
            },
            width: {
              magnitude: scaledWidth,
              unit: 'EMU'
            }
          },
          transform: {
            scaleX: 1,
            scaleY: 1,
            translateX: translateX,
            translateY: translateY,
            shearX: 0,
            shearY: 0,
            unit: 'EMU'
          }
        }
      }
    });
    requests.push({
      updateVideoProperties: {
        objectId: objectId,
        fields: 'autoPlay',
        videoProperties: {
          autoPlay: video.autoPlay
        }
      }
    });
  }

  appendCreateTableRequests(tables, requests) {
    if (tables.length > 1) {
      throw new Error('Multiple tables per slide are not supported.');
    }

    const table = tables[0];
    const tableId = (0, _utils.uuid)();
    requests.push({
      createTable: {
        objectId: tableId,
        elementProperties: {
          pageObjectId: this.slide.objectId // Use default size/transform for tables

        },
        rows: table.rows,
        columns: table.columns
      }
    });

    for (let r in table.cells) {
      let row = table.cells[r];

      for (let c in row) {
        this.appendInsertTextRequests(row[c], {
          objectId: tableId,
          cellLocation: {
            rowIndex: r,
            columnIndex: c
          }
        }, requests);
      }
    }
  }

  calculateBoundingBox(element) {
    const height = element.size.height.magnitude;
    const width = element.size.width.magnitude;
    const scaleX = element.transform.scaleX || 1;
    const scaleY = element.transform.scaleY || 1;
    const shearX = element.transform.shearX || 0;
    const shearY = element.transform.shearY || 0;
    return {
      width: scaleX * width + shearX * height,
      height: scaleY * height + shearY * width,
      x: element.transform.translateX,
      y: element.transform.translateY
    };
  }

  getBodyBoundingBox(placeholder) {
    if (placeholder) {
      return this.calculateBoundingBox(placeholder);
    }

    return {
      width: this.presentation.pageSize.width.magnitude,
      height: this.presentation.pageSize.height.magnitude,
      x: 0,
      y: 0
    };
  }

  computeShallowFieldMask(object) {
    const fields = [];

    for (var field of Object.keys(object)) {
      if (object[field] !== undefined) {
        fields.push(field);
      }
    }

    return fields.join(',');
  }

}

exports.default = GenericLayout;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sYXlvdXQvZ2VuZXJpY19sYXlvdXQudHMiXSwibmFtZXMiOlsiZGVidWciLCJHZW5lcmljTGF5b3V0IiwiY29uc3RydWN0b3IiLCJuYW1lIiwicHJlc2VudGF0aW9uIiwic2xpZGUiLCJhcHBlbmRDcmVhdGVTbGlkZVJlcXVlc3QiLCJyZXF1ZXN0cyIsImxheW91dElkIiwiRXJyb3IiLCJvYmplY3RJZCIsInB1c2giLCJjcmVhdGVTbGlkZSIsInNsaWRlTGF5b3V0UmVmZXJlbmNlIiwiYXBwZW5kQ29udGVudFJlcXVlc3RzIiwiYXBwZW5kRmlsbFBsYWNlaG9sZGVyVGV4dFJlcXVlc3QiLCJ0aXRsZSIsInN1YnRpdGxlIiwiYmFja2dyb3VuZEltYWdlIiwiYXBwZW5kU2V0QmFja2dyb3VuZEltYWdlUmVxdWVzdCIsInRhYmxlcyIsImxlbmd0aCIsImFwcGVuZENyZWF0ZVRhYmxlUmVxdWVzdHMiLCJib2RpZXMiLCJib2R5RWxlbWVudHMiLCJmb3JFYWNoIiwiYm9keSIsImluZGV4IiwicGxhY2Vob2xkZXIiLCJ0ZXh0IiwiaW1hZ2VzIiwiYXBwZW5kQ3JlYXRlSW1hZ2VSZXF1ZXN0cyIsInZpZGVvcyIsImFwcGVuZENyZWF0ZVZpZGVvUmVxdWVzdHMiLCJub3RlcyIsImFwcGVuZEluc2VydFRleHRSZXF1ZXN0cyIsInZhbHVlIiwicGFnZUVsZW1lbnRzIiwibG9jYXRpb25Qcm9wcyIsInJlcXVlc3QiLCJpbnNlcnRUZXh0IiwicmF3VGV4dCIsInRleHRSdW4iLCJ0ZXh0UnVucyIsInVwZGF0ZVRleHRTdHlsZSIsInRleHRSYW5nZSIsInR5cGUiLCJzdGFydEluZGV4Iiwic3RhcnQiLCJlbmRJbmRleCIsImVuZCIsInN0eWxlIiwiYm9sZCIsIml0YWxpYyIsImZvcmVncm91bmRDb2xvciIsImJhY2tncm91bmRDb2xvciIsInN0cmlrZXRocm91Z2giLCJ1bmRlcmxpbmUiLCJzbWFsbENhcHMiLCJmb250RmFtaWx5IiwiZm9udFNpemUiLCJsaW5rIiwiYmFzZWxpbmVPZmZzZXQiLCJmaWVsZHMiLCJjb21wdXRlU2hhbGxvd0ZpZWxkTWFzayIsImxpc3RNYXJrZXIiLCJfIiwicmV2ZXJzZSIsImxpc3RNYXJrZXJzIiwiY3JlYXRlUGFyYWdyYXBoQnVsbGV0cyIsImJ1bGxldFByZXNldCIsImltYWdlIiwidXJsIiwidXBkYXRlUGFnZVByb3BlcnRpZXMiLCJwYWdlUHJvcGVydGllcyIsInBhZ2VCYWNrZ3JvdW5kRmlsbCIsInN0cmV0Y2hlZFBpY3R1cmVGaWxsIiwiY29udGVudFVybCIsImxheWVyIiwiTGF5b3V0IiwiYWRkSXRlbSIsIndpZHRoIiwicGFkZGluZyIsImhlaWdodCIsIm1ldGEiLCJib3giLCJnZXRCb2R5Qm91bmRpbmdCb3giLCJjb21wdXRlZExheW91dCIsImV4cG9ydCIsInNjYWxlUmF0aW8iLCJNYXRoIiwibWluIiwic2NhbGVkV2lkdGgiLCJzY2FsZWRIZWlnaHQiLCJiYXNlVHJhbnNsYXRlWCIsIngiLCJiYXNlVHJhbnNsYXRlWSIsInkiLCJpdGVtIiwiaXRlbXMiLCJpdGVtT2Zmc2V0WCIsIm9mZnNldFgiLCJpdGVtT2Zmc2V0WSIsIm9mZnNldFkiLCJpdGVtUGFkZGluZyIsInRyYW5zbGF0ZVgiLCJ0cmFuc2xhdGVZIiwiY3JlYXRlSW1hZ2UiLCJlbGVtZW50UHJvcGVydGllcyIsInBhZ2VPYmplY3RJZCIsInNpemUiLCJtYWduaXR1ZGUiLCJ1bml0IiwidHJhbnNmb3JtIiwic2NhbGVYIiwic2NhbGVZIiwic2hlYXJYIiwic2hlYXJZIiwidmlkZW8iLCJpZCIsImNyZWF0ZVZpZGVvIiwic291cmNlIiwidXBkYXRlVmlkZW9Qcm9wZXJ0aWVzIiwidmlkZW9Qcm9wZXJ0aWVzIiwiYXV0b1BsYXkiLCJ0YWJsZSIsInRhYmxlSWQiLCJjcmVhdGVUYWJsZSIsInJvd3MiLCJjb2x1bW5zIiwiciIsImNlbGxzIiwicm93IiwiYyIsImNlbGxMb2NhdGlvbiIsInJvd0luZGV4IiwiY29sdW1uSW5kZXgiLCJjYWxjdWxhdGVCb3VuZGluZ0JveCIsImVsZW1lbnQiLCJwYWdlU2l6ZSIsIm9iamVjdCIsImZpZWxkIiwiT2JqZWN0Iiwia2V5cyIsInVuZGVmaW5lZCIsImpvaW4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFjQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFHQTs7Ozs7Ozs7OztBQUVBLE1BQU1BLEtBQUssR0FBRyxvQkFBTSxZQUFOLENBQWQ7O0FBU0E7QUFDQTtBQUNBO0FBQ0E7QUFDZSxNQUFNQyxhQUFOLENBQW9CO0FBS3hCQyxFQUFBQSxXQUFQLENBQW1CQyxJQUFuQixFQUFpQ0MsWUFBakMsRUFBNkVDLEtBQTdFLEVBQXFHO0FBQUE7O0FBQUE7O0FBQUE7O0FBQ2pHLFNBQUtGLElBQUwsR0FBWUEsSUFBWjtBQUNBLFNBQUtDLFlBQUwsR0FBb0JBLFlBQXBCO0FBQ0EsU0FBS0MsS0FBTCxHQUFhQSxLQUFiO0FBQ0g7O0FBRU1DLEVBQUFBLHdCQUFQLENBQWdDQyxRQUFoQyxFQUFnRztBQUM1RixVQUFNQyxRQUFRLEdBQUcsOENBQW1CLEtBQUtKLFlBQXhCLEVBQXNDLEtBQUtELElBQTNDLENBQWpCOztBQUNBLFFBQUksQ0FBQ0ssUUFBTCxFQUFlO0FBQ1gsWUFBTSxJQUFJQyxLQUFKLENBQVcseUJBQXdCLEtBQUtOLElBQUssRUFBN0MsQ0FBTjtBQUNIOztBQUNELFNBQUtFLEtBQUwsQ0FBV0ssUUFBWCxHQUFzQixrQkFBdEI7QUFFQVYsSUFBQUEsS0FBSyxDQUFDLGtDQUFELEVBQXFDLEtBQUtLLEtBQUwsQ0FBV0ssUUFBaEQsRUFBMEQsS0FBS1AsSUFBL0QsQ0FBTDtBQUNBSSxJQUFBQSxRQUFRLENBQUNJLElBQVQsQ0FBYztBQUNWQyxNQUFBQSxXQUFXLEVBQUU7QUFDVEMsUUFBQUEsb0JBQW9CLEVBQUU7QUFDbEJMLFVBQUFBLFFBQVEsRUFBRUE7QUFEUSxTQURiO0FBSVRFLFFBQUFBLFFBQVEsRUFBRSxLQUFLTCxLQUFMLENBQVdLO0FBSlo7QUFESCxLQUFkO0FBUUEsV0FBT0gsUUFBUDtBQUNIOztBQUVN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LFNBQXRCLEVBQWlDO0FBQzdCakYsUUFBQUEsTUFBTSxDQUFDcEQsSUFBUCxDQUFZa0ksS0FBWjtBQUNIO0FBQ0o7O0FBQ0QsV0FBTzlFLE1BQU0sQ0FBQ2tGLElBQVAsQ0FBWSxHQUFaLENBQVA7QUFDSDs7QUF0WDhCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IERlYnVnIGZyb20gJ2RlYnVnJztcbmltcG9ydCB7IHV1aWQgfSBmcm9tICcuLi91dGlscyc7XG5pbXBvcnQgZXh0ZW5kIGZyb20gJ2V4dGVuZCc7XG5pbXBvcnQgTGF5b3V0IGZyb20gJ2xheW91dCc7XG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBzbGlkZXNfdjEgYXMgU2xpZGVzVjEgfSBmcm9tICdnb29nbGVhcGlzJztcbmltcG9ydCB7IFNsaWRlRGVmaW5pdGlvbiwgVGV4dERlZmluaXRpb24sIFZpZGVvRGVmaW5pdGlvbiB9IGZyb20gJy4uL3NsaWRlcyc7XG5pbXBvcnQgeyBmaW5kTGF5b3V0SWRCeU5hbWUsIGZpbmRQbGFjZWhvbGRlciwgZmluZFNwZWFrZXJOb3Rlc09iamVjdElkIH0gZnJvbSAnLi9wcmVzZW50YXRpb25faGVscGVycyc7XG5cbmNvbnN0IGRlYnVnID0gRGVidWcoJ21kMmdzbGlkZXMnKTtcblxuaW50ZXJmYWNlIEJvdW5kaW5nQm94IHtcbiAgICBoZWlnaHQ6IG51bWJlcjtcbiAgICB3aWR0aDogbnVtYmVyO1xuICAgIHg6IG51bWJlcjtcbiAgICB5OiBudW1iZXI7XG59XG5cbi8qKlxuICogUGVyZm9ybXMgbW9zdCBvZiB0aGUgd29yayBvZiBjb252ZXJ0aW5nIGEgc2xpZGUgaW50byBBUEkgcmVxdWVzdHMuXG4gKlxuICovXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHZW5lcmljTGF5b3V0IHtcbiAgICBwdWJsaWMgbmFtZTogc3RyaW5nO1xuICAgIHB1YmxpYyBwcmVzZW50YXRpb246IFNsaWRlc1YxLlNjaGVtYSRQcmVzZW50YXRpb247XG4gICAgcHJpdmF0ZSBzbGlkZTogU2xpZGVEZWZpbml0aW9uO1xuXG4gICAgcHVibGljIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgcHJlc2VudGF0aW9uOiBTbGlkZXNWMS5TY2hlbWEkUHJlc2VudGF0aW9uLCBzbGlkZTogU2xpZGVEZWZpbml0aW9uKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMucHJlc2VudGF0aW9uID0gcHJlc2VudGF0aW9uO1xuICAgICAgICB0aGlzLnNsaWRlID0gc2xpZGU7XG4gICAgfVxuXG4gICAgcHVibGljIGFwcGVuZENyZWF0ZVNsaWRlUmVxdWVzdChyZXF1ZXN0czogU2xpZGVzVjEuU2NoZW1hJFJlcXVlc3RbXSk6IFNsaWRlc1YxLlNjaGVtYSRSZXF1ZXN0W10ge1xuICAgICAgICBjb25zdCBsYXlvdXRJZCA9IGZpbmRMYXlvdXRJZEJ5TmFtZSh0aGlzLnByZXNlbnRhdGlvbiwgdGhpcy5uYW1lKTtcbiAgICAgICAgaWYgKCFsYXlvdXRJZCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmFibGUgdG8gZmluZCBsYXlvdXQgJHt0aGlzLm5hbWV9YCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zbGlkZS5vYmplY3RJZCA9IHV1aWQoKTtcblxuICAgICAgICBkZWJ1ZygnQ3JlYXRpbmcgc2xpZGUgJXMgd2l0aCBsYXlvdXQgJXMnLCB0aGlzLnNsaWRlLm9iamVjdElkLCB0aGlzLm5hbWUpO1xuICAgICAgICByZXF1ZXN0cy5wdXNoKHtcbiAgICAgICAgICAgIGNyZWF0ZVNsaWRlOiB7XG4gICAgICAgICAgICAgICAgc2xpZGVMYXlvdXRSZWZlcmVuY2U6IHtcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0SWQ6IGxheW91dElkLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgb2JqZWN0SWQ6IHRoaXMuc2xpZGUub2JqZWN0SWQsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlcXVlc3RzO1xuICAgIH1cblxuICAgIHB1YmxpYyBhcHBlbmRDb250ZW50UmVxdWVzdHMocmVxdWVzdHM6IFNsaWRlc1YxLlNjaGVtYSRSZXF1ZXN0W10pOiBTbGlkZXNWMS5TY2hlbWEkUmVxdWVzdFtdIHtcbiAgICAgICAgdGhpcy5hcHBlbmRGaWxsUGxhY2Vob2xkZXJUZXh0UmVxdWVzdCh0aGlzLnNsaWRlLnRpdGxlLCAnVElUTEUnLCByZXF1ZXN0cyk7XG4gICAgICAgIHRoaXMuYXBwZW5kRmlsbFBsYWNlaG9sZGVyVGV4dFJlcXVlc3QodGhpcy5zbGlkZS50aXRsZSwgJ0NFTlRFUkVEX1RJVExFJywgcmVxdWVzdHMpO1xuICAgICAgICB0aGlzLmFwcGVuZEZpbGxQbGFjZWhvbGRlclRleHRSZXF1ZXN0KHRoaXMuc2xpZGUuc3VidGl0bGUsICdTVUJUSVRMRScsIHJlcXVlc3RzKTtcblxuICAgICAgICBpZiAodGhpcy5zbGlkZS5iYWNrZ3JvdW5kSW1hZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuYXBwZW5kU2V0QmFja2dyb3VuZEltYWdlUmVxdWVzdCh0aGlzLnNsaWRlLmJhY2tncm91bmRJbWFnZSwgcmVxdWVzdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuc2xpZGUudGFibGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGhpcy5hcHBlbmRDcmVhdGVUYWJsZVJlcXVlc3RzKHRoaXMuc2xpZGUudGFibGVzLCByZXF1ZXN0cyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zbGlkZS5ib2RpZXMpIHtcbiAgICAgICAgICAgIGNvbnN0IGJvZHlFbGVtZW50cyA9IGZpbmRQbGFjZWhvbGRlcih0aGlzLnByZXNlbnRhdGlvbiwgdGhpcy5zbGlkZS5vYmplY3RJZCwgJ0JPRFknKTtcbiAgICAgICAgICAgIHRoaXMuc2xpZGUuYm9kaWVzLmZvckVhY2goKGJvZHksIGluZGV4KSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IHBsYWNlaG9sZGVyID0gYm9keUVsZW1lbnRzW2luZGV4XTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZEZpbGxQbGFjZWhvbGRlclRleHRSZXF1ZXN0KGJvZHkudGV4dCwgcGxhY2Vob2xkZXIsIHJlcXVlc3RzKTtcbiAgICAgICAgICAgICAgICBpZiAoYm9keS5pbWFnZXMgJiYgYm9keS5pbWFnZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kQ3JlYXRlSW1hZ2VSZXF1ZXN0cyhib2R5LmltYWdlcywgcGxhY2Vob2xkZXIsIHJlcXVlc3RzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGJvZHkudmlkZW9zICYmIGJvZHkudmlkZW9zLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZENyZWF0ZVZpZGVvUmVxdWVzdHMoYm9keS52aWRlb3MsIHBsYWNlaG9sZGVyLCByZXF1ZXN0cyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5zbGlkZS5ub3Rlcykge1xuICAgICAgICAgICAgY29uc3Qgb2JqZWN0SWQgPSBmaW5kU3BlYWtlck5vdGVzT2JqZWN0SWQodGhpcy5wcmVzZW50YXRpb24sIHRoaXMuc2xpZGUub2JqZWN0SWQpO1xuICAgICAgICAgICAgdGhpcy5hcHBlbmRJbnNlcnRUZXh0UmVxdWVzdHModGhpcy5zbGlkZS5ub3RlcywgeyBvYmplY3RJZDogb2JqZWN0SWQgfSwgcmVxdWVzdHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlcXVlc3RzO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhcHBlbmRGaWxsUGxhY2Vob2xkZXJUZXh0UmVxdWVzdChcbiAgICAgICAgdmFsdWU6IFRleHREZWZpbml0aW9uLFxuICAgICAgICBwbGFjZWhvbGRlcjogc3RyaW5nIHwgU2xpZGVzVjEuU2NoZW1hJFBhZ2VFbGVtZW50LFxuICAgICAgICByZXF1ZXN0czogU2xpZGVzVjEuU2NoZW1hJFJlcXVlc3RbXSxcbiAgICApOiBTbGlkZXNWMS5TY2hlbWEkUmVxdWVzdFtdIHtcbiAgICAgICAgaWYgKCF2YWx1ZSkge1xuICAgICAgICAgICAgZGVidWcoJ05vIHRleHQgZm9yIHBsYWNlaG9sZGVyICVzJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodHlwZW9mIHBsYWNlaG9sZGVyID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgY29uc3QgcGFnZUVsZW1lbnRzID0gZmluZFBsYWNlaG9sZGVyKHRoaXMucHJlc2VudGF0aW9uLCB0aGlzLnNsaWRlLm9iamVjdElkLCBwbGFjZWhvbGRlcik7XG4gICAgICAgICAgICBpZiAoIXBhZ2VFbGVtZW50cykge1xuICAgICAgICAgICAgICAgIGRlYnVnKCdTa2lwcGluZyB1bmRlZmluZWQgcGxhY2Vob2xkZXIgJXMnLCBwbGFjZWhvbGRlcik7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGxhY2Vob2xkZXIgPSBwYWdlRWxlbWVudHNbMF07XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmFwcGVuZEluc2VydFRleHRSZXF1ZXN0cyh2YWx1ZSwgeyBvYmplY3RJZDogcGxhY2Vob2xkZXIub2JqZWN0SWQgfSwgcmVxdWVzdHMpO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhcHBlbmRJbnNlcnRUZXh0UmVxdWVzdHModGV4dDogVGV4dERlZmluaXRpb24sIGxvY2F0aW9uUHJvcHMsIHJlcXVlc3RzOiBTbGlkZXNWMS5TY2hlbWEkUmVxdWVzdFtdKTogdm9pZCB7XG4gICAgICAgIC8vIEluc2VydCB0aGUgcmF3IHRleHQgZmlyc3RcbiAgICAgICAgbGV0IHJlcXVlc3QgPSB7XG4gICAgICAgICAgICBpbnNlcnRUZXh0OiBleHRlbmQoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0LnJhd1RleHQsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBsb2NhdGlvblByb3BzLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgfTtcbiAgICAgICAgcmVxdWVzdHMucHVzaChyZXF1ZXN0KTtcblxuICAgICAgICAvLyBBcHBseSBhbnkgdGV4dCBzdHlsZXMgcHJlc2VudC5cbiAgICAgICAgLy8gTW9zdCBvZiB0aGUgd29yayBmb3IgZ2VuZXJhdGluZyB0aGUgdGV4dCBydW5zXG4gICAgICAgIC8vIGlzIHBlcmZvcm1lZCB3aGVuIHBhcnNpbmcgbWFya2Rvd24uXG4gICAgICAgIGZvciAobGV0IHRleHRSdW4gb2YgdGV4dC50ZXh0UnVucykge1xuICAgICAgICAgICAgbGV0IHJlcXVlc3Q6IFNsaWRlc1YxLlNjaGVtYSRSZXF1ZXN0ID0ge1xuICAgICAgICAgICAgICAgIHVwZGF0ZVRleHRTdHlsZTogZXh0ZW5kKFxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0UmFuZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnRklYRURfUkFOR0UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0SW5kZXg6IHRleHRSdW4uc3RhcnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kSW5kZXg6IHRleHRSdW4uZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9sZDogdGV4dFJ1bi5ib2xkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0YWxpYzogdGV4dFJ1bi5pdGFsaWMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yZWdyb3VuZENvbG9yOiB0ZXh0UnVuLmZvcmVncm91bmRDb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHRleHRSdW4uYmFja2dyb3VuZENvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmlrZXRocm91Z2g6IHRleHRSdW4uc3RyaWtldGhyb3VnaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bmRlcmxpbmU6IHRleHRSdW4udW5kZXJsaW5lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNtYWxsQ2FwczogdGV4dFJ1bi5zbWFsbENhcHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9udEZhbWlseTogdGV4dFJ1bi5mb250RmFtaWx5LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnRTaXplOiB0ZXh0UnVuLmZvbnRTaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6IHRleHRSdW4ubGluayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiYXNlbGluZU9mZnNldDogdGV4dFJ1bi5iYXNlbGluZU9mZnNldCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uUHJvcHMsXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXF1ZXN0LnVwZGF0ZVRleHRTdHlsZS5maWVsZHMgPSB0aGlzLmNvbXB1dGVTaGFsbG93RmllbGRNYXNrKHJlcXVlc3QudXBkYXRlVGV4dFN0eWxlLnN0eWxlKTtcbiAgICAgICAgICAgIGlmIChyZXF1ZXN0LnVwZGF0ZVRleHRTdHlsZS5maWVsZHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgcmVxdWVzdHMucHVzaChyZXF1ZXN0KTsgLy8gT25seSBwdXNoIGlmIGF0IGxlYXN0IG9uZSBzdHlsZSBzZXRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbnZlcnQgcGFyYWdyYXBocyB0byBsaXN0cy5cbiAgICAgICAgLy8gTm90ZSB0aGF0IGxlYWRpbmcgdGFicyBmb3IgbmVzdGVkIGxpc3RzIGluIHRoZSByYXcgdGV4dCBhcmUgcmVtb3ZlZC5cbiAgICAgICAgLy8gSW4gdGhpcyBjYXNlLCB3ZSdyZSBhc3N1bWluZyB0aGF0IGxpc3RzIGFyZSBzdXBwbGllZCBpbiBvcmRlciBvZlxuICAgICAgICAvLyBhcHBlYXJhbmNlIGFuZCB0aGV5J3JlIG5vbi1vdmVybGFwcGluZy5cbiAgICAgICAgLy8gUHJvY2Vzc2luZyBpbiB0aGUgcmV2ZXJzZSBvcmRlciBhdm9pZHMgaGF2aW5nIHRvIHJlYWRqdXN0IGluZGljZXMuXG4gICAgICAgIGZvciAobGV0IGxpc3RNYXJrZXIgb2YgXy5yZXZlcnNlKHRleHQubGlzdE1hcmtlcnMpKSB7XG4gICAgICAgICAgICBsZXQgcmVxdWVzdCA9IHtcbiAgICAgICAgICAgICAgICBjcmVhdGVQYXJhZ3JhcGhCdWxsZXRzOiBleHRlbmQoXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRSYW5nZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdGSVhFRF9SQU5HRScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnRJbmRleDogbGlzdE1hcmtlci5zdGFydCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbmRJbmRleDogbGlzdE1hcmtlci5lbmQsXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgYnVsbGV0UHJlc2V0OlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3RNYXJrZXIudHlwZSA9PSAnb3JkZXJlZCcgPyAnTlVNQkVSRURfRElHSVRfQUxQSEFfUk9NQU4nIDogJ0JVTExFVF9ESVNDX0NJUkNMRV9TUVVBUkUnLFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvblByb3BzLFxuICAgICAgICAgICAgICAgICksXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmVxdWVzdHMucHVzaChyZXF1ZXN0KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBhcHBlbmRTZXRCYWNrZ3JvdW5kSW1hZ2VSZXF1ZXN0KGltYWdlLCByZXF1ZXN0czogU2xpZGVzVjEuU2NoZW1hJFJlcXVlc3RbXSk6IHZvaWQge1xuICAgICAgICBkZWJ1ZygnU2xpZGUgIyVkOiBzZXR0aW5nIGJhY2tncm91bmQgaW1hZ2UgdG8gJXMnLCB0aGlzLnNsaWRlLmluZGV4LCBpbWFnZS51cmwpO1xuXG4gICAgICAgIHJlcXVlc3RzLnB1c2goe1xuICAgICAgICAgICAgdXBkYXRlUGFnZVByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICBvYmplY3RJZDogdGhpcy5zbGlkZS5vYmplY3RJZCxcbiAgICAgICAgICAgICAgICBmaWVsZHM6ICdwYWdlQmFja2dyb3VuZEZpbGwuc3RyZXRjaGVkUGljdHVyZUZpbGwuY29udGVudFVybCcsXG4gICAgICAgICAgICAgICAgcGFnZVByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZUJhY2tncm91bmRGaWxsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJldGNoZWRQaWN0dXJlRmlsbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnRVcmw6IGltYWdlLnVybCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBhcHBlbmRDcmVhdGVJbWFnZVJlcXVlc3RzKGltYWdlcywgcGxhY2Vob2xkZXIsIHJlcXVlc3RzOiBTbGlkZXNWMS5TY2hlbWEkUmVxdWVzdFtdKTogdm9pZCB7XG4gICAgICAgIC8vIFRPRE8gLSBGaXggd2VpcmQgY2FzdFxuICAgICAgICBjb25zdCBsYXllciA9IChMYXlvdXQgYXMgKHM6IHN0cmluZykgPT4gTGF5b3V0LlBhY2tpbmdTbWl0aCkoJ2xlZnQtcmlnaHQnKTsgLy8gVE9ETyAtIENvbmZpZ3VyYWJsZT9cbiAgICAgICAgZm9yIChsZXQgaW1hZ2Ugb2YgaW1hZ2VzKSB7XG4gICAgICAgICAgICBkZWJ1ZygnU2xpZGUgIyVkOiBhZGRpbmcgaW5saW5lIGltYWdlICVzJywgdGhpcy5zbGlkZS5pbmRleCwgaW1hZ2UudXJsKTtcbiAgICAgICAgICAgIGxheWVyLmFkZEl0ZW0oe1xuICAgICAgICAgICAgICAgIHdpZHRoOiBpbWFnZS53aWR0aCArIGltYWdlLnBhZGRpbmcgKiAyLFxuICAgICAgICAgICAgICAgIGhlaWdodDogaW1hZ2UuaGVpZ2h0ICsgaW1hZ2UucGFkZGluZyAqIDIsXG4gICAgICAgICAgICAgICAgbWV0YTogaW1hZ2UsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGJveCA9IHRoaXMuZ2V0Qm9keUJvdW5kaW5nQm94KHBsYWNlaG9sZGVyKTtcbiAgICAgICAgY29uc3QgY29tcHV0ZWRMYXlvdXQgPSBsYXllci5leHBvcnQoKTtcblxuICAgICAgICBsZXQgc2NhbGVSYXRpbyA9IE1hdGgubWluKGJveC53aWR0aCAvIGNvbXB1dGVkTGF5b3V0LndpZHRoLCBib3guaGVpZ2h0IC8gY29tcHV0ZWRMYXlvdXQuaGVpZ2h0KTtcblxuICAgICAgICBsZXQgc2NhbGVkV2lkdGggPSBjb21wdXRlZExheW91dC53aWR0aCAqIHNjYWxlUmF0aW87XG4gICAgICAgIGxldCBzY2FsZWRIZWlnaHQgPSBjb21wdXRlZExheW91dC5oZWlnaHQgKiBzY2FsZVJhdGlvO1xuXG4gICAgICAgIGxldCBiYXNlVHJhbnNsYXRlWCA9IGJveC54ICsgKGJveC53aWR0aCAtIHNjYWxlZFdpZHRoKSAvIDI7XG4gICAgICAgIGxldCBiYXNlVHJhbnNsYXRlWSA9IGJveC55ICsgKGJveC5oZWlnaHQgLSBzY2FsZWRIZWlnaHQpIC8gMjtcblxuICAgICAgICBmb3IgKGxldCBpdGVtIG9mIGNvbXB1dGVkTGF5b3V0Lml0ZW1zKSB7XG4gICAgICAgICAgICBsZXQgaXRlbU9mZnNldFggPSBpdGVtLm1ldGEub2Zmc2V0WCA/IGl0ZW0ubWV0YS5vZmZzZXRYIDogMDtcbiAgICAgICAgICAgIGxldCBpdGVtT2Zmc2V0WSA9IGl0ZW0ubWV0YS5vZmZzZXRZID8gaXRlbS5tZXRhLm9mZnNldFkgOiAwO1xuICAgICAgICAgICAgbGV0IGl0ZW1QYWRkaW5nID0gaXRlbS5tZXRhLnBhZGRpbmcgPyBpdGVtLm1ldGEucGFkZGluZyA6IDA7XG4gICAgICAgICAgICBsZXQgd2lkdGggPSBpdGVtLm1ldGEud2lkdGggKiBzY2FsZVJhdGlvO1xuICAgICAgICAgICAgbGV0IGhlaWdodCA9IGl0ZW0ubWV0YS5oZWlnaHQgKiBzY2FsZVJhdGlvO1xuICAgICAgICAgICAgbGV0IHRyYW5zbGF0ZVggPSBiYXNlVHJhbnNsYXRlWCArIChpdGVtLnggKyBpdGVtUGFkZGluZyArIGl0ZW1PZmZzZXRYKSAqIHNjYWxlUmF0aW87XG4gICAgICAgICAgICBsZXQgdHJhbnNsYXRlWSA9IGJhc2VUcmFuc2xhdGVZICsgKGl0ZW0ueSArIGl0ZW1QYWRkaW5nICsgaXRlbU9mZnNldFkpICogc2NhbGVSYXRpbztcblxuICAgICAgICAgICAgcmVxdWVzdHMucHVzaCh7XG4gICAgICAgICAgICAgICAgY3JlYXRlSW1hZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudFByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VPYmplY3RJZDogdGhpcy5zbGlkZS5vYmplY3RJZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFnbml0dWRlOiBoZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6ICdFTVUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFnbml0dWRlOiB3aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogJ0VNVScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZVg6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVZOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVg6IHRyYW5zbGF0ZVgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlWTogdHJhbnNsYXRlWSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaGVhclg6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hlYXJZOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6ICdFTVUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBpdGVtLm1ldGEudXJsLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBhcHBlbmRDcmVhdGVWaWRlb1JlcXVlc3RzKFxuICAgICAgICB2aWRlb3M6IFZpZGVvRGVmaW5pdGlvbltdLFxuICAgICAgICBwbGFjZWhvbGRlcixcbiAgICAgICAgcmVxdWVzdHM6IFNsaWRlc1YxLlNjaGVtYSRSZXF1ZXN0W10sXG4gICAgKTogdm9pZCB7XG4gICAgICAgIGlmICh2aWRlb3MubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdWx0aXBsZSB2aWRlb3MgcGVyIHNsaWRlIGFyZSBub3Qgc3VwcG9ydGVkLicpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHZpZGVvID0gdmlkZW9zWzBdO1xuXG4gICAgICAgIGRlYnVnKCdTbGlkZSAjJWQ6IGFkZGluZyB2aWRlbyAlcycsIHRoaXMuc2xpZGUuaW5kZXgsIHZpZGVvLmlkKTtcblxuICAgICAgICBjb25zdCBib3ggPSB0aGlzLmdldEJvZHlCb3VuZGluZ0JveChwbGFjZWhvbGRlcik7XG5cbiAgICAgICAgY29uc3Qgc2NhbGVSYXRpbyA9IE1hdGgubWluKGJveC53aWR0aCAvIHZpZGVvLndpZHRoLCBib3guaGVpZ2h0IC8gdmlkZW8uaGVpZ2h0KTtcblxuICAgICAgICBjb25zdCBzY2FsZWRXaWR0aCA9IHZpZGVvLndpZHRoICogc2NhbGVSYXRpbztcbiAgICAgICAgY29uc3Qgc2NhbGVkSGVpZ2h0ID0gdmlkZW8uaGVpZ2h0ICogc2NhbGVSYXRpbztcblxuICAgICAgICBsZXQgdHJhbnNsYXRlWCA9IGJveC54ICsgKGJveC53aWR0aCAtIHNjYWxlZFdpZHRoKSAvIDI7XG4gICAgICAgIGxldCB0cmFuc2xhdGVZID0gYm94LnkgKyAoYm94LmhlaWdodCAtIHNjYWxlZEhlaWdodCkgLyAyO1xuXG4gICAgICAgIGNvbnN0IG9iamVjdElkID0gdXVpZCgpO1xuICAgICAgICByZXF1ZXN0cy5wdXNoKHtcbiAgICAgICAgICAgIGNyZWF0ZVZpZGVvOiB7XG4gICAgICAgICAgICAgICAgc291cmNlOiAnWU9VVFVCRScsXG4gICAgICAgICAgICAgICAgb2JqZWN0SWQ6IG9iamVjdElkLFxuICAgICAgICAgICAgICAgIGlkOiB2aWRlby5pZCxcbiAgICAgICAgICAgICAgICBlbGVtZW50UHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBwYWdlT2JqZWN0SWQ6IHRoaXMuc2xpZGUub2JqZWN0SWQsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hZ25pdHVkZTogc2NhbGVkSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6ICdFTVUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFnbml0dWRlOiBzY2FsZWRXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiAnRU1VJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRyYW5zZm9ybToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVYOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVZOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNsYXRlWDogdHJhbnNsYXRlWCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zbGF0ZVk6IHRyYW5zbGF0ZVksXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVhclg6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaGVhclk6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICB1bml0OiAnRU1VJyxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJlcXVlc3RzLnB1c2goe1xuICAgICAgICAgICAgdXBkYXRlVmlkZW9Qcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgb2JqZWN0SWQ6IG9iamVjdElkLFxuICAgICAgICAgICAgICAgIGZpZWxkczogJ2F1dG9QbGF5JyxcbiAgICAgICAgICAgICAgICB2aWRlb1Byb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgYXV0b1BsYXk6IHZpZGVvLmF1dG9QbGF5LFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgYXBwZW5kQ3JlYXRlVGFibGVSZXF1ZXN0cyh0YWJsZXMsIHJlcXVlc3RzOiBTbGlkZXNWMS5TY2hlbWEkUmVxdWVzdFtdKTogdm9pZCB7XG4gICAgICAgIGlmICh0YWJsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdWx0aXBsZSB0YWJsZXMgcGVyIHNsaWRlIGFyZSBub3Qgc3VwcG9ydGVkLicpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHRhYmxlID0gdGFibGVzWzBdO1xuICAgICAgICBjb25zdCB0YWJsZUlkID0gdXVpZCgpO1xuXG4gICAgICAgIHJlcXVlc3RzLnB1c2goe1xuICAgICAgICAgICAgY3JlYXRlVGFibGU6IHtcbiAgICAgICAgICAgICAgICBvYmplY3RJZDogdGFibGVJZCxcbiAgICAgICAgICAgICAgICBlbGVtZW50UHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBwYWdlT2JqZWN0SWQ6IHRoaXMuc2xpZGUub2JqZWN0SWQsXG4gICAgICAgICAgICAgICAgICAgIC8vIFVzZSBkZWZhdWx0IHNpemUvdHJhbnNmb3JtIGZvciB0YWJsZXNcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJvd3M6IHRhYmxlLnJvd3MsXG4gICAgICAgICAgICAgICAgY29sdW1uczogdGFibGUuY29sdW1ucyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZvciAobGV0IHIgaW4gdGFibGUuY2VsbHMpIHtcbiAgICAgICAgICAgIGxldCByb3cgPSB0YWJsZS5jZWxsc1tyXTtcbiAgICAgICAgICAgIGZvciAobGV0IGMgaW4gcm93KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRJbnNlcnRUZXh0UmVxdWVzdHMoXG4gICAgICAgICAgICAgICAgICAgIHJvd1tjXSxcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0SWQ6IHRhYmxlSWQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsTG9jYXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW5JbmRleDogYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlcXVlc3RzLFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY2FsY3VsYXRlQm91bmRpbmdCb3goZWxlbWVudDogU2xpZGVzVjEuU2NoZW1hJFBhZ2VFbGVtZW50KTogQm91bmRpbmdCb3gge1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBlbGVtZW50LnNpemUuaGVpZ2h0Lm1hZ25pdHVkZTtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBlbGVtZW50LnNpemUud2lkdGgubWFnbml0dWRlO1xuICAgICAgICBjb25zdCBzY2FsZVggPSBlbGVtZW50LnRyYW5zZm9ybS5zY2FsZVggfHwgMTtcbiAgICAgICAgY29uc3Qgc2NhbGVZID0gZWxlbWVudC50cmFuc2Zvcm0uc2NhbGVZIHx8IDE7XG4gICAgICAgIGNvbnN0IHNoZWFyWCA9IGVsZW1lbnQudHJhbnNmb3JtLnNoZWFyWCB8fCAwO1xuICAgICAgICBjb25zdCBzaGVhclkgPSBlbGVtZW50LnRyYW5zZm9ybS5zaGVhclkgfHwgMDtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgd2lkdGg6IHNjYWxlWCAqIHdpZHRoICsgc2hlYXJYICogaGVpZ2h0LFxuICAgICAgICAgICAgaGVpZ2h0OiBzY2FsZVkgKiBoZWlnaHQgKyBzaGVhclkgKiB3aWR0aCxcbiAgICAgICAgICAgIHg6IGVsZW1lbnQudHJhbnNmb3JtLnRyYW5zbGF0ZVgsXG4gICAgICAgICAgICB5OiBlbGVtZW50LnRyYW5zZm9ybS50cmFuc2xhdGVZLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByb3RlY3RlZCBnZXRCb2R5Qm91bmRpbmdCb3gocGxhY2Vob2xkZXIpOiBCb3VuZGluZ0JveCB7XG4gICAgICAgIGlmIChwbGFjZWhvbGRlcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FsY3VsYXRlQm91bmRpbmdCb3gocGxhY2Vob2xkZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB3aWR0aDogdGhpcy5wcmVzZW50YXRpb24ucGFnZVNpemUud2lkdGgubWFnbml0dWRlLFxuICAgICAgICAgICAgaGVpZ2h0OiB0aGlzLnByZXNlbnRhdGlvbi5wYWdlU2l6ZS5oZWlnaHQubWFnbml0dWRlLFxuICAgICAgICAgICAgeDogMCxcbiAgICAgICAgICAgIHk6IDAsXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIGNvbXB1dGVTaGFsbG93RmllbGRNYXNrKG9iamVjdDogb2JqZWN0KTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgZmllbGRzID0gW107XG4gICAgICAgIGZvciAodmFyIGZpZWxkIG9mIE9iamVjdC5rZXlzKG9iamVjdCkpIHtcbiAgICAgICAgICAgIGlmIChvYmplY3RbZmllbGRdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBmaWVsZHMucHVzaChmaWVsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpZWxkcy5qb2luKCcsJyk7XG4gICAgfVxufVxuIl19
//# sourceMappingURL=generic_layout.js.map