"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = matchLayout;

var _generic_layout = _interopRequireDefault(require("./generic_layout"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Copyright 2016 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
const layouts = [];

function matchLayout(presentation, slide) {
  // if we have manually set the slide layout get the master from the presentation
  let layoutName = undefined;

  if (slide.customLayout !== undefined) {
    let layout = presentation.layouts.find(layout => layout.layoutProperties.displayName == slide.customLayout);

    if (layout) {
      layoutName = layout.layoutProperties.name;
    }
  }

  if (layoutName == undefined) {
    let layout = layouts.find(layout => layout.match(slide));

    if (!layout) {
      throw new Error('Failed to match layout for slide');
    }

    layoutName = layout.name;
  }

  return new _generic_layout.default(layoutName, presentation, slide);
}

function defineLayout(name, matchFn) {
  layouts.push({
    name: name,
    match: matchFn
  });
}

function hasText(text) {
  return text && text.rawText && text.rawText.length !== 0;
}

function hasBigTitle(slide) {
  return hasText(slide.title) && slide.title.big;
}

function hasTextContent(slide) {
  return slide.bodies.length !== 0;
} // Anything which takes up the main body space


function hasContent(slide) {
  return slide.bodies.length !== 0 || slide.tables.length !== 0;
} // Define rules for picking slide layouts based on the default
// layouts in Slides.
// NOTE: Order matters since first match wins.


defineLayout('TITLE', slide => hasText(slide.title) && hasText(slide.subtitle) && !hasContent(slide));
defineLayout('MAIN_POINT', slide => hasBigTitle(slide) && !hasContent(slide));
defineLayout('SECTION_HEADER', slide => hasText(slide.title) && !hasText(slide.subtitle) && !hasContent(slide));
defineLayout('SECTION_TITLE_AND_DESCRIPTION', slide => hasText(slide.title) && hasText(slide.subtitle) && hasTextContent(slide));
defineLayout('BIG_NUMBER', slide => hasBigTitle(slide) && hasTextContent(slide));
defineLayout('TITLE_AND_TWO_COLUMNS', slide => hasText(slide.title) && slide.bodies.length == 2);
defineLayout('TITLE_AND_BODY', slide => hasText(slide.title) || slide.bodies.length !== 0);
defineLayout('BLANK', () => true);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9sYXlvdXQvbWF0Y2hfbGF5b3V0LnRzIl0sIm5hbWVzIjpbImxheW91dHMiLCJtYXRjaExheW91dCIsInByZXNlbnRhdGlvbiIsInNsaWRlIiwibGF5b3V0TmFtZSIsInVuZGVmaW5lZCIsImN1c3RvbUxheW91dCIsImxheW91dCIsImZpbmQiLCJsYXlvdXRQcm9wZXJ0aWVzIiwiZGlzcGxheU5hbWUiLCJuYW1lIiwibWF0Y2giLCJFcnJvciIsIkdlbmVyaWNMYXlvdXQiLCJkZWZpbmVMYXlvdXQiLCJtYXRjaEZuIiwicHVzaCIsImhhc1RleHQiLCJ0ZXh0IiwicmF3VGV4dCIsImxlbmd0aCIsImhhc0JpZ1RpdGxlIiwidGl0bGUiLCJiaWciLCJoYXNUZXh0Q29udGVudCIsImJvZGllcyIsImhhc0NvbnRlbnQiLCJ0YWJsZXMiLCJzdWJ0aXRsZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWNBOzs7O0FBZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFhQSxNQUFNQSxPQUFpQixHQUFHLEVBQTFCOztBQUVlLFNBQVNDLFdBQVQsQ0FBcUJDLFlBQXJCLEVBQWlFQyxLQUFqRSxFQUF3RztBQUNuSDtBQUNBLE1BQUlDLFVBQWtCLEdBQUdDLFNBQXpCOztBQUNBLE1BQUlGLEtBQUssQ0FBQ0csWUFBTixLQUF1QkQsU0FBM0IsRUFBc0M7QUFDbEMsUUFBSUUsTUFBTSxHQUFHTCxZQUFZLENBQUNGLE9BQWIsQ0FBcUJRLElBQXJCLENBQTBCRCxNQUFNLElBQUlBLE1BQU0sQ0FBQ0UsZ0JBQVAsQ0FBd0JDLFdBQXhCLElBQXVDUCxLQUFLLENBQUNHLFlBQWpGLENBQWI7O0FBQ0EsUUFBSUMsTUFBSixFQUFZO0FBQ1JILE1BQUFBLFVBQVUsR0FBR0csTUFBTSxDQUFDRSxnQkFBUCxDQUF3QkUsSUFBckM7QUFDSDtBQUNKOztBQUNELE1BQUlQLFVBQVUsSUFBSUMsU0FBbEIsRUFBNkI7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UCxJQUF3QnBCLEtBQUssQ0FBQ3VCLE1BQU4sQ0FBYUwsTUFBYixLQUF3QixDQUE1RSxDQUFaO0FBQ0FOLFlBQVksQ0FBQyxPQUFELEVBQVUsTUFBTSxJQUFoQixDQUFaIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IDIwMTYgR29vZ2xlIEluYy5cbi8vXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuLy8geW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuLy8gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4vL1xuLy8gICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4vL1xuLy8gVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuLy8gZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuLy8gV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4vLyBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4vLyBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblxuaW1wb3J0IEdlbmVyaWNMYXlvdXQgZnJvbSAnLi9nZW5lcmljX2xheW91dCc7XG5pbXBvcnQgeyBzbGlkZXNfdjEgYXMgU2xpZGVzVjEgfSBmcm9tICdnb29nbGVhcGlzJztcbmltcG9ydCB7IFNsaWRlRGVmaW5pdGlvbiwgVGV4dERlZmluaXRpb24gfSBmcm9tICcuLi9zbGlkZXMnO1xuXG50eXBlIE1hdGNoRm4gPSAoc2xpZGU6IFNsaWRlRGVmaW5pdGlvbikgPT4gYm9vbGVhbjtcblxuaW50ZXJmYWNlIExheW91dCB7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIG1hdGNoOiBNYXRjaEZuO1xufVxuXG5jb25zdCBsYXlvdXRzOiBMYXlvdXRbXSA9IFtdO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtYXRjaExheW91dChwcmVzZW50YXRpb246IFNsaWRlc1YxLlNjaGVtYSRQcmVzZW50YXRpb24sIHNsaWRlOiBTbGlkZURlZmluaXRpb24pOiBHZW5lcmljTGF5b3V0IHtcbiAgICAvLyBpZiB3ZSBoYXZlIG1hbnVhbGx5IHNldCB0aGUgc2xpZGUgbGF5b3V0IGdldCB0aGUgbWFzdGVyIGZyb20gdGhlIHByZXNlbnRhdGlvblxuICAgIGxldCBsYXlvdXROYW1lOiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgaWYgKHNsaWRlLmN1c3RvbUxheW91dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxldCBsYXlvdXQgPSBwcmVzZW50YXRpb24ubGF5b3V0cy5maW5kKGxheW91dCA9PiBsYXlvdXQubGF5b3V0UHJvcGVydGllcy5kaXNwbGF5TmFtZSA9PSBzbGlkZS5jdXN0b21MYXlvdXQpO1xuICAgICAgICBpZiAobGF5b3V0KSB7XG4gICAgICAgICAgICBsYXlvdXROYW1lID0gbGF5b3V0LmxheW91dFByb3BlcnRpZXMubmFtZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAobGF5b3V0TmFtZSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgbGV0IGxheW91dCA9IGxheW91dHMuZmluZChsYXlvdXQgPT4gbGF5b3V0Lm1hdGNoKHNsaWRlKSk7XG4gICAgICAgIGlmICghbGF5b3V0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBtYXRjaCBsYXlvdXQgZm9yIHNsaWRlJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGF5b3V0TmFtZSA9IGxheW91dC5uYW1lO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IEdlbmVyaWNMYXlvdXQobGF5b3V0TmFtZSwgcHJlc2VudGF0aW9uLCBzbGlkZSk7XG59XG5cbmZ1bmN0aW9uIGRlZmluZUxheW91dChuYW1lOiBzdHJpbmcsIG1hdGNoRm46IE1hdGNoRm4pOiB2b2lkIHtcbiAgICBsYXlvdXRzLnB1c2goe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBtYXRjaDogbWF0Y2hGbixcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFzVGV4dCh0ZXh0OiBUZXh0RGVmaW5pdGlvbik6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0ZXh0ICYmIHRleHQucmF3VGV4dCAmJiB0ZXh0LnJhd1RleHQubGVuZ3RoICE9PSAwO1xufVxuXG5mdW5jdGlvbiBoYXNCaWdUaXRsZShzbGlkZTogU2xpZGVEZWZpbml0aW9uKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGhhc1RleHQoc2xpZGUudGl0bGUpICYmIHNsaWRlLnRpdGxlLmJpZztcbn1cblxuZnVuY3Rpb24gaGFzVGV4dENvbnRlbnQoc2xpZGU6IFNsaWRlRGVmaW5pdGlvbik6IGJvb2xlYW4ge1xuICAgIHJldHVybiBzbGlkZS5ib2RpZXMubGVuZ3RoICE9PSAwO1xufVxuXG4vLyBBbnl0aGluZyB3aGljaCB0YWtlcyB1cCB0aGUgbWFpbiBib2R5IHNwYWNlXG5mdW5jdGlvbiBoYXNDb250ZW50KHNsaWRlOiBTbGlkZURlZmluaXRpb24pOiBib29sZWFuIHtcbiAgICByZXR1cm4gc2xpZGUuYm9kaWVzLmxlbmd0aCAhPT0gMCB8fCBzbGlkZS50YWJsZXMubGVuZ3RoICE9PSAwO1xufVxuXG4vLyBEZWZpbmUgcnVsZXMgZm9yIHBpY2tpbmcgc2xpZGUgbGF5b3V0cyBiYXNlZCBvbiB0aGUgZGVmYXVsdFxuLy8gbGF5b3V0cyBpbiBTbGlkZXMuXG4vLyBOT1RFOiBPcmRlciBtYXR0ZXJzIHNpbmNlIGZpcnN0IG1hdGNoIHdpbnMuXG5cbmRlZmluZUxheW91dCgnVElUTEUnLCBzbGlkZSA9PiBoYXNUZXh0KHNsaWRlLnRpdGxlKSAmJiBoYXNUZXh0KHNsaWRlLnN1YnRpdGxlKSAmJiAhaGFzQ29udGVudChzbGlkZSkpO1xuZGVmaW5lTGF5b3V0KCdNQUlOX1BPSU5UJywgc2xpZGUgPT4gaGFzQmlnVGl0bGUoc2xpZGUpICYmICFoYXNDb250ZW50KHNsaWRlKSk7XG5kZWZpbmVMYXlvdXQoJ1NFQ1RJT05fSEVBREVSJywgc2xpZGUgPT4gaGFzVGV4dChzbGlkZS50aXRsZSkgJiYgIWhhc1RleHQoc2xpZGUuc3VidGl0bGUpICYmICFoYXNDb250ZW50KHNsaWRlKSk7XG5kZWZpbmVMYXlvdXQoXG4gICAgJ1NFQ1RJT05fVElUTEVfQU5EX0RFU0NSSVBUSU9OJyxcbiAgICBzbGlkZSA9PiBoYXNUZXh0KHNsaWRlLnRpdGxlKSAmJiBoYXNUZXh0KHNsaWRlLnN1YnRpdGxlKSAmJiBoYXNUZXh0Q29udGVudChzbGlkZSksXG4pO1xuZGVmaW5lTGF5b3V0KCdCSUdfTlVNQkVSJywgc2xpZGUgPT4gaGFzQmlnVGl0bGUoc2xpZGUpICYmIGhhc1RleHRDb250ZW50KHNsaWRlKSk7XG5kZWZpbmVMYXlvdXQoJ1RJVExFX0FORF9UV09fQ09MVU1OUycsIHNsaWRlID0+IGhhc1RleHQoc2xpZGUudGl0bGUpICYmIHNsaWRlLmJvZGllcy5sZW5ndGggPT0gMik7XG5kZWZpbmVMYXlvdXQoJ1RJVExFX0FORF9CT0RZJywgc2xpZGUgPT4gaGFzVGV4dChzbGlkZS50aXRsZSkgfHwgc2xpZGUuYm9kaWVzLmxlbmd0aCAhPT0gMCk7XG5kZWZpbmVMYXlvdXQoJ0JMQU5LJywgKCkgPT4gdHJ1ZSk7XG4iXX0=
//# sourceMappingURL=match_layout.js.map