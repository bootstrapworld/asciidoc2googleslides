"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = extractSlides;

var _debug = _interopRequireDefault(require("debug"));

var _extend = _interopRequireDefault(require("extend"));

var _parse = _interopRequireDefault(require("parse5"));

var _fileUrl = _interopRequireDefault(require("file-url"));

var _parser = _interopRequireDefault(require("./parser"));

var _env = require("./env");

var _syntax_highlight = _interopRequireDefault(require("./syntax_highlight"));

var _css = require("./css");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Copyright 2016 Google Inc.
//
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
//    http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
const debug = (0, _debug.default)('md2gslides');
const inlineTokenRules = {};
const fullTokenRules = {};
let ruleSet;

function attr(token, name) {
  if (!token.attrs) {
    return undefined;
  }

  let attr = token.attrs.find(a => a[0] === name);

  if (!attr) {
    return undefined;
  }

  return attr[1];
}

function hasClass(token, cls) {
  return cls == attr(token, 'class');
} // eslint-disable-next-line @typescript-eslint/no-explicit-any


function isVideo(token) {
  return token.service !== undefined && token.videoID !== undefined;
}

function processMarkdownToken(token, context) {
  debug('Token: %O', token);
  let rule = ruleSet[token.type];

  if (rule) {
    rule(token, context);
  } else {
    debug('Ignoring token %s', token.type);
  }
}

function processTokens(tokens, context) {
  tokens.forEach((token, index) => {
    if (token.type == 'hr' && index == 0) {
      return; // Skip leading HR since no previous slide
    }

    processMarkdownToken(token, context);
  });
}

function applyTokenStyle(token, style) {
  if (!token.attrs) {
    return style;
  }

  let styleAttr = token.attrs.find(attr => attr[0] === 'style');

  if (styleAttr === undefined) {
    return style;
  }

  let css = (0, _css.parseInlineStyle)(styleAttr[1]);
  (0, _css.updateStyleDefinition)(css, style);
  return style;
} // Rules for processing markdown tokens
// These rules are specific to parsing markdown in an inline context.


inlineTokenRules['heading_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    bold: true
  });
  context.startStyle(style); // TODO - Better style for inline headers
};

inlineTokenRules['heading_close'] = (token, context) => context.endStyle();

inlineTokenRules['inline'] = (token, context) => {
  for (let child of token.children) {
    processMarkdownToken(child, context);
  }
};

inlineTokenRules['html_inline'] = (token, context) => {
  const fragment = _parse.default.parseFragment(context.inlineHtmlContext, token.content);

  if (fragment.childNodes && fragment.childNodes.length) {
    const node = fragment.childNodes[0];
    let style = {};

    switch (node.nodeName) {
      case 'strong':
      case 'b':
        style.bold = true;
        break;

      case 'em':
      case 'i':
        style.italic = true;
        break;

      case 'code':
        style.fontFamily = 'Courier New';
        break;

      case 'sub':
        style.baselineOffset = 'SUBSCRIPT';
        break;

      case 'sup':
        style.baselineOffset = 'SUPERSCRIPT';
        break;

      case 'span':
        break;

      case '#comment':
        // Depending on spacing, comment blocks
        // sometimes appear as inline elements
        fullTokenRules['html_block'](token, context);
        return;

      default:
        throw new Error('Unsupported inline HTML element: ' + node.nodeName);
    }

    let styleAttr = node.attrs.find(attr => attr.name === 'style');

    if (styleAttr) {
      let css = (0, _css.parseInlineStyle)(styleAttr.value);
      (0, _css.updateStyleDefinition)(css, style);
    }

    context.inlineHtmlContext = fragment.childNodes[0];
    context.startStyle(style);
  } else {
    context.endStyle();
  }
};

inlineTokenRules['text'] = (token, context) => {
  const style = applyTokenStyle(token, {});
  context.startStyle(style);
  context.appendText(token.content);
  context.endStyle();
};

inlineTokenRules['paragraph_open'] = (token, context) => {
  if (hasClass(token, 'column')) {
    context.markerParagraph = true;
    let body = {
      text: context.text,
      images: context.images,
      videos: context.videos
    };
    context.images = [];
    context.videos = [];
    context.currentSlide.bodies.push(body);
    context.startTextBlock();
  } else if (!context.text) {
    context.startTextBlock();
  }

  var layout = attr(token, 'layout'); // If we have a layout attribute set this on the slide so we can select the
  // right master template when building the deck

  if (layout != undefined && layout != '') {
    context.currentSlide.customLayout = layout;
  }
};

inlineTokenRules['paragraph_close'] = (token, context) => {
  if (context.markerParagraph) {
    // Empty column marker, just clear flag
    context.markerParagraph = false;
  } else {
    context.appendText('\n');
  }
};

inlineTokenRules['fence'] = (token, context) => {
  const style = applyTokenStyle(token, {
    fontFamily: 'Courier New'
  });
  context.startStyle(style);
  const language = token.info ? token.info.trim() : undefined;

  if (language) {
    (0, _syntax_highlight.default)(token.content, language, context);
  } else {
    // For code blocks, replace line feeds with vertical tabs to keep
    // the block as a single paragraph. This avoid the extra vertical
    // space that appears between paragraphs
    context.appendText(token.content.replace(/\n/g, '\u000b'));
  }

  context.appendText('\n');
  context.endStyle();
};

inlineTokenRules['em_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    italic: true
  });
  context.startStyle(style);
};

inlineTokenRules['em_close'] = (token, context) => context.endStyle();

inlineTokenRules['s_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    strikethrough: true
  });
  context.startStyle(style);
};

inlineTokenRules['s_close'] = (token, context) => context.endStyle();

inlineTokenRules['strong_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    bold: true
  });
  context.startStyle(style);
};

inlineTokenRules['strong_close'] = (token, context) => context.endStyle();

inlineTokenRules['link_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    link: {
      url: attr(token, 'href')
    }
  });
  context.startStyle(style);
};

inlineTokenRules['link_close'] = (token, context) => context.endStyle();

inlineTokenRules['code_inline'] = (token, context) => {
  const style = applyTokenStyle(token, {
    fontFamily: 'Courier New'
  });
  context.startStyle(style);
  context.appendText(token.content);
  context.endStyle();
};

inlineTokenRules['hardbreak'] = (token, context) => context.appendText('\u000b');

inlineTokenRules['softbreak'] = (token, context) => context.appendText(' ');

inlineTokenRules['blockquote_open'] = (token, context) => {
  // TODO - More interesting styling for block quotes
  const style = applyTokenStyle(token, {
    italic: true
  });
  context.startStyle(style);
};

inlineTokenRules['blockquote_close'] = (token, context) => context.endStyle();

inlineTokenRules['emoji'] = (token, context) => context.appendText(token.content);

inlineTokenRules['bullet_list_open'] = inlineTokenRules['ordered_list_open'] = (token, context) => {
  const style = applyTokenStyle(token, {});
  context.startStyle(style);

  if (context.list) {
    if (context.list.tag != token.tag) {
      throw new Error('Nested lists must match parent style');
    }

    context.list.depth += 1;
  } else {
    context.list = {
      depth: 0,
      tag: token.tag,
      start: context.text.rawText.length
    };
  }
};

inlineTokenRules['bullet_list_close'] = inlineTokenRules['ordered_list_close'] = (token, context) => {
  if (context.list.depth == 0) {
    // TODO - Support nested lists with mixed styles when API supports it.
    // Currently nested lists must match the parent style.
    context.text.listMarkers.push({
      start: context.list.start,
      end: context.text.rawText.length,
      type: token.tag == 'ul' ? 'unordered' : 'ordered'
    });
    context.list = null;
  } else {
    context.list.depth -= 1;
  }

  context.endStyle();
};

inlineTokenRules['list_item_open'] = (token, context) => {
  const style = applyTokenStyle(token, {});
  context.startStyle(style);
  context.appendText(new Array(context.list.depth + 1).join('\t'));
};

inlineTokenRules['list_item_close'] = (token, context) => context.endStyle(); // Additional rules for processing the entire document
// Extends inline rules with support for additional
// tokens that only make sense in the context of a slide
// or presentation


(0, _extend.default)(fullTokenRules, inlineTokenRules);

fullTokenRules['heading_open'] = (token, context) => {
  const style = applyTokenStyle(token, {});
  context.startTextBlock();
  context.startStyle(style);
  context.text.big = hasClass(token, 'big');
};

fullTokenRules['heading_close'] = (token, context) => {
  if (token.tag == 'h1') {
    context.currentSlide.title = context.text;
  } else if (token.tag == 'h2') {
    context.currentSlide.subtitle = context.text;
  } else {
    debug('Ignoring header element %s', token.tag);
  }

  context.endStyle();
  context.startTextBlock();
};

fullTokenRules['html_block'] = (token, context) => {
  var re = /<!--([\s\S]*)-->/m;
  var match = re.exec(token.content);

  if (match == null) {
    throw new Error('Unsupported HTML block: ' + token.content);
  } // Since the notes can contain unparsed markdown, create a new environment
  // to process it so we don't inadvertently lose state. Just carry
  // forward the notes from the current slide to append to


  var subContext = new _env.Context(context.css);
  ruleSet = inlineTokenRules;

  if (context.currentSlide.notes) {
    subContext.text = context.currentSlide.notes;
  } else {
    subContext.startTextBlock();
  }

  var tokens = (0, _parser.default)(match[1]);
  processTokens(tokens, subContext);

  if (subContext.text && subContext.text.rawText.trim().length) {
    context.currentSlide.notes = subContext.text;
  }

  ruleSet = fullTokenRules;
};

fullTokenRules['hr'] = (token, context) => {
  context.endSlide();
  context.startSlide();
};

fullTokenRules['image'] = (token, context) => {
  let url = attr(token, 'src');

  if (!url.match(/(file|https?):/)) {
    url = (0, _fileUrl.default)(url);
  }

  const image = {
    url: url,
    width: undefined,
    height: undefined,
    padding: 0,
    offsetX: 0,
    offsetY: 0
  };
  const padding = attr(token, 'pad');

  if (padding) {
    image.padding = parseInt(padding);
  }

  const offsetX = attr(token, 'offset-x');

  if (offsetX) {
    image.offsetX = parseInt(offsetX);
  }

  const offsetY = attr(token, 'offset-y');

  if (offsetY) {
    image.offsetY = parseInt(offsetY);
  }

  if (hasClass(token, 'background')) {
    context.currentSlide.backgroundImage = image;
  } else {
    context.images.push(image);
  }
};

fullTokenRules['video'] = (token, context) => {
  if (!isVideo(token)) {
    return;
  }

  if (token.service != 'youtube') {
    throw new Error('Only YouTube videos allowed');
  } // Assume 16:9 aspect ratio


  const video = {
    width: 1600,
    height: 900,
    autoPlay: true,
    id: token.videoID
  };
  context.videos.push(video);
};

fullTokenRules['table_open'] = (token, context) => {
  const style = applyTokenStyle(token, {});
  context.startStyle(style);
  context.table = {
    rows: 0,
    columns: 0,
    cells: []
  };
};

fullTokenRules['table_close'] = (token, context) => {
  context.currentSlide.tables.push(context.table);
  context.endStyle();
};

fullTokenRules['thead_open'] = () => {};

fullTokenRules['thead_close'] = () => {};

fullTokenRules['tbody_open'] = () => {};

fullTokenRules['tbody_close'] = () => {};

fullTokenRules['tr_open'] = (token, context) => {
  const style = applyTokenStyle(token, {});
  context.startStyle(style);
  context.row = [];
};

fullTokenRules['tr_close'] = (token, context) => {
  const row = context.row;
  context.table.cells.push(row);
  context.table.columns = Math.max(context.table.columns, row.length);
  context.table.rows = context.table.cells.length;
  context.endStyle();
};

fullTokenRules['td_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    foregroundColor: {
      opaqueColor: {
        themeColor: 'TEXT1'
      }
    }
  });
  context.startStyle(style);
  context.startTextBlock();
};

fullTokenRules['th_open'] = (token, context) => {
  const style = applyTokenStyle(token, {
    bold: true,
    // Note: Non-placeholder elements aren't aware of the slide theme.
    // Set the foreground color to match the primary text color of the
    // theme.
    foregroundColor: {
      opaqueColor: {
        themeColor: 'TEXT1'
      }
    }
  });
  context.startStyle(style);
  context.startTextBlock();
};

fullTokenRules['td_close'] = fullTokenRules['th_close'] = (token, context) => {
  context.endStyle();
  context.row.push(context.text);
  context.startTextBlock();
};

fullTokenRules['generated_image'] = (token, context) => {
  const image = {
    source: token.content,
    type: token.info.trim(),
    width: undefined,
    height: undefined,
    style: attr(token, 'style'),
    padding: 0,
    offsetX: 0,
    offsetY: 0
  };
  const padding = attr(token, 'pad');

  if (padding) {
    image.padding = parseInt(padding);
  }

  if (hasClass(token, 'background')) {
    context.currentSlide.backgroundImage = image;
  } else {
    context.images.push(image);
  }
};
/**
 * Parse the markdown and converts it into a form more suitable
 * for creating slides.
 *
 * Returns an array of objects where each item represents an individual
 * slide.
 *
 * @param {string} markdown
 * @param {string} stylesheet
 * @returns {Promise.<Array>}
 */


function extractSlides(markdown, stylesheet = null) {
  let tokens = (0, _parser.default)(markdown);
  let css = (0, _css.parseStyleSheet)(stylesheet);
  let context = new _env.Context(css);
  ruleSet = fullTokenRules; // TODO - Make not global

  processTokens(tokens, context);
  context.done();
  debug('Slides %O', context.slides);
  return context.slides;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9wYXJzZXIvZXh0cmFjdF9zbGlkZXMudHMiXSwibmFtZXMiOlsiZGVidWciLCJpbmxpbmVUb2tlblJ1bGVzIiwiZnVsbFRva2VuUnVsZXMiLCJydWxlU2V0IiwiYXR0ciIsInRva2VuIiwibmFtZSIsImF0dHJzIiwidW5kZWZpbmVkIiwiZmluZCIsImEiLCJoYXNDbGFzcyIsImNscyIsImlzVmlkZW8iLCJzZXJ2aWNlIiwidmlkZW9JRCIsInByb2Nlc3NNYXJrZG93blRva2VuIiwiY29udGV4dCIsInJ1bGUiLCJ0eXBlIiwicHJvY2Vzc1Rva2VucyIsInRva2VucyIsImZvckVhY2giLCJpbmRleCIsImFwcGx5VG9rZW5TdHlsZSIsInN0eWxlIiwic3R5bGVBdHRyIiwiY3NzIiwiYm9sZCIsInN0YXJ0U3R5bGUiLCJlbmRTdHlsZSIsImNoaWxkIiwiY2hpbGRyZW4iLCJmcmFnbWVudCIsInBhcnNlNSIsInBhcnNlRnJhZ21lbnQiLCJpbmxpbmVIdG1sQ29udGV4dCIsImNvbnRlbnQiLCJjaGlsZE5vZGVzIiwibGVuZ3RoIiwibm9kZSIsIm5vZGVOYW1lIiwiaXRhbGljIiwiZm9udEZhbWlseSIsImJhc2VsaW5lT2Zmc2V0IiwiRXJyb3IiLCJ2YWx1ZSIsImFwcGVuZFRleHQiLCJtYXJrZXJQYXJhZ3JhcGgiLCJib2R5IiwidGV4dCIsImltYWdlcyIsInZpZGVvcyIsImN1cnJlbnRTbGlkZSIsImJvZGllcyIsInB1c2giLCJzdGFydFRleHRCbG9jayIsImxheW91dCIsImN1c3RvbUxheW91dCIsImxhbmd1YWdlIiwiaW5mbyIsInRyaW0iLCJyZXBsYWNlIiwic3RyaWtldGhyb3VnaCIsImxpbmsiLCJ1cmwiLCJsaXN0IiwidGFnIiwiZGVwdGgiLCJzdGFydCIsInJhd1RleHQiLCJsaXN0TWFya2VycyIsImVuZCIsIkFycmF5Iiwiam9pbiIsImJpZyIsInRpdGxlIiwic3VidGl0bGUiLCJyZSIsIm1hdGNoIiwiZXhlYyIsInN1YkNvbnRleHQiLCJDb250ZXh0Iiwibm90ZXMiLCJlbmRTbGlkZSIsInN0YXJ0U2xpZGUiLCJpbWFnZSIsIndpZHRoIiwiaGVpZ2h0IiwicGFkZGluZyIsIm9mZnNldFgiLCJvZmZzZXRZIiwicGFyc2VJbnQiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJ2aWRlbyIsImF1dG9QbGF5IiwiaWQiLCJ0YWJsZSIsInJvd3MiLCJjb2x1bW5zIiwiY2VsbHMiLCJ0YWJsZXMiLCJyb3ciLCJNYXRoIiwibWF4IiwiZm9yZWdyb3VuZENvbG9yIiwib3BhcXVlQ29sb3IiLCJ0aGVtZUNvbG9yIiwic291cmNlIiwiZXh0cmFjdFNsaWRlcyIsIm1hcmtkb3duIiwic3R5bGVzaGVldCIsImRvbmUiLCJzbGlkZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFjQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7OztBQXZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWFBLE1BQU1BLEtBQUssR0FBRyxvQkFBTSxZQUFOLENBQWQ7QUFZQSxNQUFNQyxnQkFBK0IsR0FBRyxFQUF4QztBQUNBLE1BQU1DLGNBQTZCLEdBQUcsRUFBdEM7QUFFQSxJQUFJQyxPQUFKOztBQUVBLFNBQVNDLElBQVQsQ0FBY0MsS0FBZCxFQUE0QkMsSUFBNUIsRUFBa0Q7QUFDOUMsTUFBSSxDQUFDRCxLQUFLLENBQUNFLEtBQVgsRUFBa0I7QUFDZCxXQUFPQyxTQUFQO0FBQ0g7O0FBQ0QsTUFBSUosSUFBSSxHQUFHQyxLQUFLLENBQUNFLEtBQU4sQ0FBWUUsSUFBWixDQUFpQkMsQ0FBQyxJQUFJQSxDQUFDLENBQUMsQ0FBRCxDQUFELEtBQVNKLElBQS9CLENBQVg7O0FBQ0EsTUFBSSxDQUFDRixJQUFMLEVBQVc7QUFDUCxXQUFPSSxTQUFQO0FBQ0g7O0FBQ0QsU0FBT0osSUFBSSxDQUFDLENBQUQsQ0FBWDtBQUNIOztBQUVELFNBQVNPLFFBQVQsQ0FBa0JOLEtBQWxCLEVBQXlC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QUFaLEVBQW1DO0FBQy9CWSxJQUFBQSxPQUFPLENBQUNvQyxZQUFSLENBQXFCd0MsZUFBckIsR0FBdUNQLEtBQXZDO0FBQ0gsR0FGRCxNQUVPO0FBQ0hyRSxJQUFBQSxPQUFPLENBQUNrQyxNQUFSLENBQWVJLElBQWYsQ0FBb0IrQixLQUFwQjtBQUNIO0FBQ0osQ0FwQkQ7QUFzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBQ2UsU0FBU3VCLGFBQVQsQ0FBdUJDLFFBQXZCLEVBQXlDQyxVQUFrQixHQUFHLElBQTlELEVBQXVGO0FBQ2xHLE1BQUkxRixNQUFNLEdBQUcscUJBQWN5RixRQUFkLENBQWI7QUFDQSxNQUFJbkYsR0FBRyxHQUFHLDBCQUFnQm9GLFVBQWhCLENBQVY7QUFDQSxNQUFJOUYsT0FBTyxHQUFHLElBQUlpRSxZQUFKLENBQVl2RCxHQUFaLENBQWQ7QUFDQXhCLEVBQUFBLE9BQU8sR0FBR0QsY0FBVixDQUprRyxDQUl4RTs7QUFDMUJrQixFQUFBQSxhQUFhLENBQUNDLE1BQUQsRUFBU0osT0FBVCxDQUFiO0FBQ0FBLEVBQUFBLE9BQU8sQ0FBQytGLElBQVI7QUFDQWhILEVBQUFBLEtBQUssQ0FBQyxXQUFELEVBQWNpQixPQUFPLENBQUNnRyxNQUF0QixDQUFMO0FBQ0EsU0FBT2hHLE9BQU8sQ0FBQ2dHLE1BQWY7QUFDSCIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAyMDE2IEdvb2dsZSBJbmMuXG4vL1xuLy8gTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbi8vIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbi8vIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuLy9cbi8vICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuLy9cbi8vIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbi8vIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbi8vIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuLy8gU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuLy8gbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cbmltcG9ydCBEZWJ1ZyBmcm9tICdkZWJ1Zyc7XG5pbXBvcnQgZXh0ZW5kIGZyb20gJ2V4dGVuZCc7XG5pbXBvcnQgVG9rZW4gZnJvbSAnbWFya2Rvd24taXQvbGliL3Rva2VuJztcbmltcG9ydCBwYXJzZTUgZnJvbSAncGFyc2U1JztcbmltcG9ydCBmaWxlVXJsIGZyb20gJ2ZpbGUtdXJsJztcbmltcG9ydCB7IFNsaWRlRGVmaW5pdGlvbiwgU3R5bGVEZWZpbml0aW9uIH0gZnJvbSAnLi4vc2xpZGVzJztcbmltcG9ydCBwYXJzZU1hcmtkb3duIGZyb20gJy4vcGFyc2VyJztcbmltcG9ydCB7IENvbnRleHQgfSBmcm9tICcuL2Vudic7XG5pbXBvcnQgaGlnaGxpZ2h0U3ludGF4IGZyb20gJy4vc3ludGF4X2hpZ2hsaWdodCc7XG5pbXBvcnQgeyBwYXJzZVN0eWxlU2hlZXQsIHBhcnNlSW5saW5lU3R5bGUsIHVwZGF0ZVN0eWxlRGVmaW5pdGlvbiB9IGZyb20gJy4vY3NzJztcblxuY29uc3QgZGVidWcgPSBEZWJ1ZygnbWQyZ3NsaWRlcycpO1xuXG50eXBlIE1hcmtkb3duUnVsZUZuID0gKHRva2VuOiBUb2tlbiwgY29udGV4dDogQ29udGV4dCkgPT4gdm9pZDtcbmludGVyZmFjZSBNYXJrZG93blJ1bGVzIHtcbiAgICBbazogc3RyaW5nXTogTWFya2Rvd25SdWxlRm47XG59XG5cbmludGVyZmFjZSBWaWRlb1Rva2VuIGV4dGVuZHMgVG9rZW4ge1xuICAgIHNlcnZpY2U6IHN0cmluZztcbiAgICB2aWRlb0lEOiBzdHJpbmc7XG59XG5cbmNvbnN0IGlubGluZVRva2VuUnVsZXM6IE1hcmtkb3duUnVsZXMgPSB7fTtcbmNvbnN0IGZ1bGxUb2tlblJ1bGVzOiBNYXJrZG93blJ1bGVzID0ge307XG5cbmxldCBydWxlU2V0OiBNYXJrZG93blJ1bGVzO1xuXG5mdW5jdGlvbiBhdHRyKHRva2VuOiBUb2tlbiwgbmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICBpZiAoIXRva2VuLmF0dHJzKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIGxldCBhdHRyID0gdG9rZW4uYXR0cnMuZmluZChhID0+IGFbMF0gPT09IG5hbWUpO1xuICAgIGlmICghYXR0cikge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gYXR0clsxXTtcbn1cblxuZnVuY3Rpb24gaGFzQ2xhc3ModG9rZW4sIGNscyk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBjbHMgPT0gYXR0cih0b2tlbiwgJ2NsYXNzJyk7XG59XG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG5mdW5jdGlvbiBpc1ZpZGVvKHRva2VuOiBhbnkpOiB0b2tlbiBpcyBWaWRlb1Rva2VuIHtcbiAgICByZXR1cm4gdG9rZW4uc2VydmljZSAhPT0gdW5kZWZpbmVkICYmIHRva2VuLnZpZGVvSUQgIT09IHVuZGVmaW5lZDtcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc01hcmtkb3duVG9rZW4odG9rZW46IFRva2VuLCBjb250ZXh0OiBDb250ZXh0KTogdm9pZCB7XG4gICAgZGVidWcoJ1Rva2VuOiAlTycsIHRva2VuKTtcbiAgICBsZXQgcnVsZSA9IHJ1bGVTZXRbdG9rZW4udHlwZV07XG4gICAgaWYgKHJ1bGUpIHtcbiAgICAgICAgcnVsZSh0b2tlbiwgY29udGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZGVidWcoJ0lnbm9yaW5nIHRva2VuICVzJywgdG9rZW4udHlwZSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBwcm9jZXNzVG9rZW5zKHRva2VuczogVG9rZW5bXSwgY29udGV4dDogQ29udGV4dCk6IHZvaWQge1xuICAgIHRva2Vucy5mb3JFYWNoKCh0b2tlbiwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKHRva2VuLnR5cGUgPT0gJ2hyJyAmJiBpbmRleCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm47IC8vIFNraXAgbGVhZGluZyBIUiBzaW5jZSBubyBwcmV2aW91cyBzbGlkZVxuICAgICAgICB9XG4gICAgICAgIHByb2Nlc3NNYXJrZG93blRva2VuKHRva2VuLCBjb250ZXh0KTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYXBwbHlUb2tlblN0eWxlKHRva2VuOiBUb2tlbiwgc3R5bGU6IFN0eWxlRGVmaW5pdGlvbik6IFN0eWxlRGVmaW5pdGlvbiB7XG4gICAgaWYgKCF0b2tlbi5hdHRycykge1xuICAgICAgICByZXR1cm4gc3R5bGU7XG4gICAgfVxuICAgIGxldCBzdHlsZUF0dHIgPSB0b2tlbi5hdHRycy5maW5kKGF0dHIgPT4gYXR0clswXSA9PT0gJ3N0eWxlJyk7XG4gICAgaWYgKHN0eWxlQXR0ciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJldHVybiBzdHlsZTtcbiAgICB9XG5cbiAgICBsZXQgY3NzID0gcGFyc2VJbmxpbmVTdHlsZShzdHlsZUF0dHJbMV0pO1xuICAgIHVwZGF0ZVN0eWxlRGVmaW5pdGlvbihjc3MsIHN0eWxlKTtcbiAgICByZXR1cm4gc3R5bGU7XG59XG5cbi8vIFJ1bGVzIGZvciBwcm9jZXNzaW5nIG1hcmtkb3duIHRva2Vuc1xuXG4vLyBUaGVzZSBydWxlcyBhcmUgc3BlY2lmaWMgdG8gcGFyc2luZyBtYXJrZG93biBpbiBhbiBpbmxpbmUgY29udGV4dC5cblxuaW5saW5lVG9rZW5SdWxlc1snaGVhZGluZ19vcGVuJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwgeyBib2xkOiB0cnVlIH0pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7IC8vIFRPRE8gLSBCZXR0ZXIgc3R5bGUgZm9yIGlubGluZSBoZWFkZXJzXG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWydoZWFkaW5nX2Nsb3NlJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IGNvbnRleHQuZW5kU3R5bGUoKTtcblxuaW5saW5lVG9rZW5SdWxlc1snaW5saW5lJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBmb3IgKGxldCBjaGlsZCBvZiB0b2tlbi5jaGlsZHJlbikge1xuICAgICAgICBwcm9jZXNzTWFya2Rvd25Ub2tlbihjaGlsZCwgY29udGV4dCk7XG4gICAgfVxufTtcblxuaW5saW5lVG9rZW5SdWxlc1snaHRtbF9pbmxpbmUnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IGZyYWdtZW50ID0gcGFyc2U1LnBhcnNlRnJhZ21lbnQoY29udGV4dC5pbmxpbmVIdG1sQ29udGV4dCwgdG9rZW4uY29udGVudCk7XG4gICAgaWYgKGZyYWdtZW50LmNoaWxkTm9kZXMgJiYgZnJhZ21lbnQuY2hpbGROb2Rlcy5sZW5ndGgpIHtcbiAgICAgICAgY29uc3Qgbm9kZSA9IGZyYWdtZW50LmNoaWxkTm9kZXNbMF07XG4gICAgICAgIGxldCBzdHlsZTogU3R5bGVEZWZpbml0aW9uID0ge307XG5cbiAgICAgICAgc3dpdGNoIChub2RlLm5vZGVOYW1lKSB7XG4gICAgICAgICAgICBjYXNlICdzdHJvbmcnOlxuICAgICAgICAgICAgY2FzZSAnYic6XG4gICAgICAgICAgICAgICAgc3R5bGUuYm9sZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbSc6XG4gICAgICAgICAgICBjYXNlICdpJzpcbiAgICAgICAgICAgICAgICBzdHlsZS5pdGFsaWMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnY29kZSc6XG4gICAgICAgICAgICAgICAgc3R5bGUuZm9udEZhbWlseSA9ICdDb3VyaWVyIE5ldyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzdWInOlxuICAgICAgICAgICAgICAgIHN0eWxlLmJhc2VsaW5lT2Zmc2V0ID0gJ1NVQlNDUklQVCc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzdXAnOlxuICAgICAgICAgICAgICAgIHN0eWxlLmJhc2VsaW5lT2Zmc2V0ID0gJ1NVUEVSU0NSSVBUJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NwYW4nOlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnI2NvbW1lbnQnOlxuICAgICAgICAgICAgICAgIC8vIERlcGVuZGluZyBvbiBzcGFjaW5nLCBjb21tZW50IGJsb2Nrc1xuICAgICAgICAgICAgICAgIC8vIHNvbWV0aW1lcyBhcHBlYXIgYXMgaW5saW5lIGVsZW1lbnRzXG4gICAgICAgICAgICAgICAgZnVsbFRva2VuUnVsZXNbJ2h0bWxfYmxvY2snXSh0b2tlbiwgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1Vuc3VwcG9ydGVkIGlubGluZSBIVE1MIGVsZW1lbnQ6ICcgKyBub2RlLm5vZGVOYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBzdHlsZUF0dHIgPSBub2RlLmF0dHJzLmZpbmQoYXR0ciA9PiBhdHRyLm5hbWUgPT09ICdzdHlsZScpO1xuICAgICAgICBpZiAoc3R5bGVBdHRyKSB7XG4gICAgICAgICAgICBsZXQgY3NzID0gcGFyc2VJbmxpbmVTdHlsZShzdHlsZUF0dHIudmFsdWUpO1xuICAgICAgICAgICAgdXBkYXRlU3R5bGVEZWZpbml0aW9uKGNzcywgc3R5bGUpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHQuaW5saW5lSHRtbENvbnRleHQgPSBmcmFnbWVudC5jaGlsZE5vZGVzWzBdO1xuICAgICAgICBjb250ZXh0LnN0YXJ0U3R5bGUoc3R5bGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRleHQuZW5kU3R5bGUoKTtcbiAgICB9XG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWyd0ZXh0J10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwge30pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29udGV4dC5hcHBlbmRUZXh0KHRva2VuLmNvbnRlbnQpO1xuICAgIGNvbnRleHQuZW5kU3R5bGUoKTtcbn07XG5cbmlubGluZVRva2VuUnVsZXNbJ3BhcmFncmFwaF9vcGVuJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBpZiAoaGFzQ2xhc3ModG9rZW4sICdjb2x1bW4nKSkge1xuICAgICAgICBjb250ZXh0Lm1hcmtlclBhcmFncmFwaCA9IHRydWU7XG4gICAgICAgIGxldCBib2R5ID0ge1xuICAgICAgICAgICAgdGV4dDogY29udGV4dC50ZXh0LFxuICAgICAgICAgICAgaW1hZ2VzOiBjb250ZXh0LmltYWdlcyxcbiAgICAgICAgICAgIHZpZGVvczogY29udGV4dC52aWRlb3MsXG4gICAgICAgIH07XG4gICAgICAgIGNvbnRleHQuaW1hZ2VzID0gW107XG4gICAgICAgIGNvbnRleHQudmlkZW9zID0gW107XG4gICAgICAgIGNvbnRleHQuY3VycmVudFNsaWRlLmJvZGllcy5wdXNoKGJvZHkpO1xuICAgICAgICBjb250ZXh0LnN0YXJ0VGV4dEJsb2NrKCk7XG4gICAgfSBlbHNlIGlmICghY29udGV4dC50ZXh0KSB7XG4gICAgICAgIGNvbnRleHQuc3RhcnRUZXh0QmxvY2soKTtcbiAgICB9XG5cbiAgICB2YXIgbGF5b3V0ID0gYXR0cih0b2tlbiwgJ2xheW91dCcpO1xuICAgIC8vIElmIHdlIGhhdmUgYSBsYXlvdXQgYXR0cmlidXRlIHNldCB0aGlzIG9uIHRoZSBzbGlkZSBzbyB3ZSBjYW4gc2VsZWN0IHRoZVxuICAgIC8vIHJpZ2h0IG1hc3RlciB0ZW1wbGF0ZSB3aGVuIGJ1aWxkaW5nIHRoZSBkZWNrXG4gICAgaWYgKGxheW91dCAhPSB1bmRlZmluZWQgJiYgbGF5b3V0ICE9ICcnKSB7XG4gICAgICAgIGNvbnRleHQuY3VycmVudFNsaWRlLmN1c3RvbUxheW91dCA9IGxheW91dDtcbiAgICB9XG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWydwYXJhZ3JhcGhfY2xvc2UnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGlmIChjb250ZXh0Lm1hcmtlclBhcmFncmFwaCkge1xuICAgICAgICAvLyBFbXB0eSBjb2x1bW4gbWFya2VyLCBqdXN0IGNsZWFyIGZsYWdcbiAgICAgICAgY29udGV4dC5tYXJrZXJQYXJhZ3JhcGggPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0LmFwcGVuZFRleHQoJ1xcbicpO1xuICAgIH1cbn07XG5cbmlubGluZVRva2VuUnVsZXNbJ2ZlbmNlJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwgeyBmb250RmFtaWx5OiAnQ291cmllciBOZXcnIH0pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29uc3QgbGFuZ3VhZ2UgPSB0b2tlbi5pbmZvID8gdG9rZW4uaW5mby50cmltKCkgOiB1bmRlZmluZWQ7XG4gICAgaWYgKGxhbmd1YWdlKSB7XG4gICAgICAgIGhpZ2hsaWdodFN5bnRheCh0b2tlbi5jb250ZW50LCBsYW5ndWFnZSwgY29udGV4dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIGNvZGUgYmxvY2tzLCByZXBsYWNlIGxpbmUgZmVlZHMgd2l0aCB2ZXJ0aWNhbCB0YWJzIHRvIGtlZXBcbiAgICAgICAgLy8gdGhlIGJsb2NrIGFzIGEgc2luZ2xlIHBhcmFncmFwaC4gVGhpcyBhdm9pZCB0aGUgZXh0cmEgdmVydGljYWxcbiAgICAgICAgLy8gc3BhY2UgdGhhdCBhcHBlYXJzIGJldHdlZW4gcGFyYWdyYXBoc1xuICAgICAgICBjb250ZXh0LmFwcGVuZFRleHQodG9rZW4uY29udGVudC5yZXBsYWNlKC9cXG4vZywgJ1xcdTAwMGInKSk7XG4gICAgfVxuICAgIGNvbnRleHQuYXBwZW5kVGV4dCgnXFxuJyk7XG4gICAgY29udGV4dC5lbmRTdHlsZSgpO1xufTtcblxuaW5saW5lVG9rZW5SdWxlc1snZW1fb3BlbiddID0gKHRva2VuLCBjb250ZXh0KSA9PiB7XG4gICAgY29uc3Qgc3R5bGUgPSBhcHBseVRva2VuU3R5bGUodG9rZW4sIHsgaXRhbGljOiB0cnVlIH0pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWydlbV9jbG9zZSddID0gKHRva2VuLCBjb250ZXh0KSA9PiBjb250ZXh0LmVuZFN0eWxlKCk7XG5cbmlubGluZVRva2VuUnVsZXNbJ3Nfb3BlbiddID0gKHRva2VuLCBjb250ZXh0KSA9PiB7XG4gICAgY29uc3Qgc3R5bGUgPSBhcHBseVRva2VuU3R5bGUodG9rZW4sIHsgc3RyaWtldGhyb3VnaDogdHJ1ZSB9KTtcbiAgICBjb250ZXh0LnN0YXJ0U3R5bGUoc3R5bGUpO1xufTtcblxuaW5saW5lVG9rZW5SdWxlc1snc19jbG9zZSddID0gKHRva2VuLCBjb250ZXh0KSA9PiBjb250ZXh0LmVuZFN0eWxlKCk7XG5cbmlubGluZVRva2VuUnVsZXNbJ3N0cm9uZ19vcGVuJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwgeyBib2xkOiB0cnVlIH0pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWydzdHJvbmdfY2xvc2UnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4gY29udGV4dC5lbmRTdHlsZSgpO1xuXG5pbmxpbmVUb2tlblJ1bGVzWydsaW5rX29wZW4nXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IHN0eWxlID0gYXBwbHlUb2tlblN0eWxlKHRva2VuLCB7XG4gICAgICAgIGxpbms6IHtcbiAgICAgICAgICAgIHVybDogYXR0cih0b2tlbiwgJ2hyZWYnKSxcbiAgICAgICAgfSxcbiAgICB9KTtcbiAgICBjb250ZXh0LnN0YXJ0U3R5bGUoc3R5bGUpO1xufTtcblxuaW5saW5lVG9rZW5SdWxlc1snbGlua19jbG9zZSddID0gKHRva2VuLCBjb250ZXh0KSA9PiBjb250ZXh0LmVuZFN0eWxlKCk7XG5cbmlubGluZVRva2VuUnVsZXNbJ2NvZGVfaW5saW5lJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwgeyBmb250RmFtaWx5OiAnQ291cmllciBOZXcnIH0pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29udGV4dC5hcHBlbmRUZXh0KHRva2VuLmNvbnRlbnQpO1xuICAgIGNvbnRleHQuZW5kU3R5bGUoKTtcbn07XG5cbmlubGluZVRva2VuUnVsZXNbJ2hhcmRicmVhayddID0gKHRva2VuLCBjb250ZXh0KSA9PiBjb250ZXh0LmFwcGVuZFRleHQoJ1xcdTAwMGInKTtcblxuaW5saW5lVG9rZW5SdWxlc1snc29mdGJyZWFrJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IGNvbnRleHQuYXBwZW5kVGV4dCgnICcpO1xuXG5pbmxpbmVUb2tlblJ1bGVzWydibG9ja3F1b3RlX29wZW4nXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIC8vIFRPRE8gLSBNb3JlIGludGVyZXN0aW5nIHN0eWxpbmcgZm9yIGJsb2NrIHF1b3Rlc1xuICAgIGNvbnN0IHN0eWxlID0gYXBwbHlUb2tlblN0eWxlKHRva2VuLCB7IGl0YWxpYzogdHJ1ZSB9KTtcbiAgICBjb250ZXh0LnN0YXJ0U3R5bGUoc3R5bGUpO1xufTtcblxuaW5saW5lVG9rZW5SdWxlc1snYmxvY2txdW90ZV9jbG9zZSddID0gKHRva2VuLCBjb250ZXh0KSA9PiBjb250ZXh0LmVuZFN0eWxlKCk7XG5cbmlubGluZVRva2VuUnVsZXNbJ2Vtb2ppJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IGNvbnRleHQuYXBwZW5kVGV4dCh0b2tlbi5jb250ZW50KTtcblxuaW5saW5lVG9rZW5SdWxlc1snYnVsbGV0X2xpc3Rfb3BlbiddID0gaW5saW5lVG9rZW5SdWxlc1snb3JkZXJlZF9saXN0X29wZW4nXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IHN0eWxlID0gYXBwbHlUb2tlblN0eWxlKHRva2VuLCB7fSk7XG4gICAgY29udGV4dC5zdGFydFN0eWxlKHN0eWxlKTtcbiAgICBpZiAoY29udGV4dC5saXN0KSB7XG4gICAgICAgIGlmIChjb250ZXh0Lmxpc3QudGFnICE9IHRva2VuLnRhZykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOZXN0ZWQgbGlzdHMgbXVzdCBtYXRjaCBwYXJlbnQgc3R5bGUnKTtcbiAgICAgICAgfVxuICAgICAgICBjb250ZXh0Lmxpc3QuZGVwdGggKz0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0Lmxpc3QgPSB7XG4gICAgICAgICAgICBkZXB0aDogMCxcbiAgICAgICAgICAgIHRhZzogdG9rZW4udGFnLFxuICAgICAgICAgICAgc3RhcnQ6IGNvbnRleHQudGV4dC5yYXdUZXh0Lmxlbmd0aCxcbiAgICAgICAgfTtcbiAgICB9XG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWydidWxsZXRfbGlzdF9jbG9zZSddID0gaW5saW5lVG9rZW5SdWxlc1snb3JkZXJlZF9saXN0X2Nsb3NlJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBpZiAoY29udGV4dC5saXN0LmRlcHRoID09IDApIHtcbiAgICAgICAgLy8gVE9ETyAtIFN1cHBvcnQgbmVzdGVkIGxpc3RzIHdpdGggbWl4ZWQgc3R5bGVzIHdoZW4gQVBJIHN1cHBvcnRzIGl0LlxuICAgICAgICAvLyBDdXJyZW50bHkgbmVzdGVkIGxpc3RzIG11c3QgbWF0Y2ggdGhlIHBhcmVudCBzdHlsZS5cbiAgICAgICAgY29udGV4dC50ZXh0Lmxpc3RNYXJrZXJzLnB1c2goe1xuICAgICAgICAgICAgc3RhcnQ6IGNvbnRleHQubGlzdC5zdGFydCxcbiAgICAgICAgICAgIGVuZDogY29udGV4dC50ZXh0LnJhd1RleHQubGVuZ3RoLFxuICAgICAgICAgICAgdHlwZTogdG9rZW4udGFnID09ICd1bCcgPyAndW5vcmRlcmVkJyA6ICdvcmRlcmVkJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnRleHQubGlzdCA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29udGV4dC5saXN0LmRlcHRoIC09IDE7XG4gICAgfVxuICAgIGNvbnRleHQuZW5kU3R5bGUoKTtcbn07XG5cbmlubGluZVRva2VuUnVsZXNbJ2xpc3RfaXRlbV9vcGVuJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwge30pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29udGV4dC5hcHBlbmRUZXh0KG5ldyBBcnJheShjb250ZXh0Lmxpc3QuZGVwdGggKyAxKS5qb2luKCdcXHQnKSk7XG59O1xuXG5pbmxpbmVUb2tlblJ1bGVzWydsaXN0X2l0ZW1fY2xvc2UnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4gY29udGV4dC5lbmRTdHlsZSgpO1xuXG4vLyBBZGRpdGlvbmFsIHJ1bGVzIGZvciBwcm9jZXNzaW5nIHRoZSBlbnRpcmUgZG9jdW1lbnRcbi8vIEV4dGVuZHMgaW5saW5lIHJ1bGVzIHdpdGggc3VwcG9ydCBmb3IgYWRkaXRpb25hbFxuLy8gdG9rZW5zIHRoYXQgb25seSBtYWtlIHNlbnNlIGluIHRoZSBjb250ZXh0IG9mIGEgc2xpZGVcbi8vIG9yIHByZXNlbnRhdGlvblxuZXh0ZW5kKGZ1bGxUb2tlblJ1bGVzLCBpbmxpbmVUb2tlblJ1bGVzKTtcblxuZnVsbFRva2VuUnVsZXNbJ2hlYWRpbmdfb3BlbiddID0gKHRva2VuLCBjb250ZXh0KSA9PiB7XG4gICAgY29uc3Qgc3R5bGUgPSBhcHBseVRva2VuU3R5bGUodG9rZW4sIHt9KTtcbiAgICBjb250ZXh0LnN0YXJ0VGV4dEJsb2NrKCk7XG4gICAgY29udGV4dC5zdGFydFN0eWxlKHN0eWxlKTtcbiAgICBjb250ZXh0LnRleHQuYmlnID0gaGFzQ2xhc3ModG9rZW4sICdiaWcnKTtcbn07XG5cbmZ1bGxUb2tlblJ1bGVzWydoZWFkaW5nX2Nsb3NlJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBpZiAodG9rZW4udGFnID09ICdoMScpIHtcbiAgICAgICAgY29udGV4dC5jdXJyZW50U2xpZGUudGl0bGUgPSBjb250ZXh0LnRleHQ7XG4gICAgfSBlbHNlIGlmICh0b2tlbi50YWcgPT0gJ2gyJykge1xuICAgICAgICBjb250ZXh0LmN1cnJlbnRTbGlkZS5zdWJ0aXRsZSA9IGNvbnRleHQudGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBkZWJ1ZygnSWdub3JpbmcgaGVhZGVyIGVsZW1lbnQgJXMnLCB0b2tlbi50YWcpO1xuICAgIH1cbiAgICBjb250ZXh0LmVuZFN0eWxlKCk7XG4gICAgY29udGV4dC5zdGFydFRleHRCbG9jaygpO1xufTtcblxuZnVsbFRva2VuUnVsZXNbJ2h0bWxfYmxvY2snXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIHZhciByZSA9IC88IS0tKFtcXHNcXFNdKiktLT4vbTtcbiAgICB2YXIgbWF0Y2ggPSByZS5leGVjKHRva2VuLmNvbnRlbnQpO1xuICAgIGlmIChtYXRjaCA9PSBudWxsKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgSFRNTCBibG9jazogJyArIHRva2VuLmNvbnRlbnQpO1xuICAgIH1cbiAgICAvLyBTaW5jZSB0aGUgbm90ZXMgY2FuIGNvbnRhaW4gdW5wYXJzZWQgbWFya2Rvd24sIGNyZWF0ZSBhIG5ldyBlbnZpcm9ubWVudFxuICAgIC8vIHRvIHByb2Nlc3MgaXQgc28gd2UgZG9uJ3QgaW5hZHZlcnRlbnRseSBsb3NlIHN0YXRlLiBKdXN0IGNhcnJ5XG4gICAgLy8gZm9yd2FyZCB0aGUgbm90ZXMgZnJvbSB0aGUgY3VycmVudCBzbGlkZSB0byBhcHBlbmQgdG9cbiAgICB2YXIgc3ViQ29udGV4dCA9IG5ldyBDb250ZXh0KGNvbnRleHQuY3NzKTtcbiAgICBydWxlU2V0ID0gaW5saW5lVG9rZW5SdWxlcztcbiAgICBpZiAoY29udGV4dC5jdXJyZW50U2xpZGUubm90ZXMpIHtcbiAgICAgICAgc3ViQ29udGV4dC50ZXh0ID0gY29udGV4dC5jdXJyZW50U2xpZGUubm90ZXM7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgc3ViQ29udGV4dC5zdGFydFRleHRCbG9jaygpO1xuICAgIH1cbiAgICB2YXIgdG9rZW5zID0gcGFyc2VNYXJrZG93bihtYXRjaFsxXSk7XG4gICAgcHJvY2Vzc1Rva2Vucyh0b2tlbnMsIHN1YkNvbnRleHQpO1xuICAgIGlmIChzdWJDb250ZXh0LnRleHQgJiYgc3ViQ29udGV4dC50ZXh0LnJhd1RleHQudHJpbSgpLmxlbmd0aCkge1xuICAgICAgICBjb250ZXh0LmN1cnJlbnRTbGlkZS5ub3RlcyA9IHN1YkNvbnRleHQudGV4dDtcbiAgICB9XG4gICAgcnVsZVNldCA9IGZ1bGxUb2tlblJ1bGVzO1xufTtcblxuZnVsbFRva2VuUnVsZXNbJ2hyJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb250ZXh0LmVuZFNsaWRlKCk7XG4gICAgY29udGV4dC5zdGFydFNsaWRlKCk7XG59O1xuXG5mdWxsVG9rZW5SdWxlc1snaW1hZ2UnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGxldCB1cmwgPSBhdHRyKHRva2VuLCAnc3JjJyk7XG4gICAgaWYgKCF1cmwubWF0Y2goLyhmaWxlfGh0dHBzPyk6LykpIHtcbiAgICAgICAgdXJsID0gZmlsZVVybCh1cmwpO1xuICAgIH1cbiAgICBjb25zdCBpbWFnZSA9IHtcbiAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgIHdpZHRoOiB1bmRlZmluZWQsXG4gICAgICAgIGhlaWdodDogdW5kZWZpbmVkLFxuICAgICAgICBwYWRkaW5nOiAwLFxuICAgICAgICBvZmZzZXRYOiAwLFxuICAgICAgICBvZmZzZXRZOiAwLFxuICAgIH07XG5cbiAgICBjb25zdCBwYWRkaW5nID0gYXR0cih0b2tlbiwgJ3BhZCcpO1xuICAgIGlmIChwYWRkaW5nKSB7XG4gICAgICAgIGltYWdlLnBhZGRpbmcgPSBwYXJzZUludChwYWRkaW5nKTtcbiAgICB9XG5cbiAgICBjb25zdCBvZmZzZXRYID0gYXR0cih0b2tlbiwgJ29mZnNldC14Jyk7XG4gICAgaWYgKG9mZnNldFgpIHtcbiAgICAgICAgaW1hZ2Uub2Zmc2V0WCA9IHBhcnNlSW50KG9mZnNldFgpO1xuICAgIH1cblxuICAgIGNvbnN0IG9mZnNldFkgPSBhdHRyKHRva2VuLCAnb2Zmc2V0LXknKTtcbiAgICBpZiAob2Zmc2V0WSkge1xuICAgICAgICBpbWFnZS5vZmZzZXRZID0gcGFyc2VJbnQob2Zmc2V0WSk7XG4gICAgfVxuXG4gICAgaWYgKGhhc0NsYXNzKHRva2VuLCAnYmFja2dyb3VuZCcpKSB7XG4gICAgICAgIGNvbnRleHQuY3VycmVudFNsaWRlLmJhY2tncm91bmRJbWFnZSA9IGltYWdlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRleHQuaW1hZ2VzLnB1c2goaW1hZ2UpO1xuICAgIH1cbn07XG5cbmZ1bGxUb2tlblJ1bGVzWyd2aWRlbyddID0gKHRva2VuLCBjb250ZXh0KSA9PiB7XG4gICAgaWYgKCFpc1ZpZGVvKHRva2VuKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0b2tlbi5zZXJ2aWNlICE9ICd5b3V0dWJlJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09ubHkgWW91VHViZSB2aWRlb3MgYWxsb3dlZCcpO1xuICAgIH1cbiAgICAvLyBBc3N1bWUgMTY6OSBhc3BlY3QgcmF0aW9cbiAgICBjb25zdCB2aWRlbyA9IHtcbiAgICAgICAgd2lkdGg6IDE2MDAsXG4gICAgICAgIGhlaWdodDogOTAwLFxuICAgICAgICBhdXRvUGxheTogdHJ1ZSxcbiAgICAgICAgaWQ6IHRva2VuLnZpZGVvSUQsXG4gICAgfTtcbiAgICBjb250ZXh0LnZpZGVvcy5wdXNoKHZpZGVvKTtcbn07XG5cbmZ1bGxUb2tlblJ1bGVzWyd0YWJsZV9vcGVuJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwge30pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29udGV4dC50YWJsZSA9IHtcbiAgICAgICAgcm93czogMCxcbiAgICAgICAgY29sdW1uczogMCxcbiAgICAgICAgY2VsbHM6IFtdLFxuICAgIH07XG59O1xuXG5mdWxsVG9rZW5SdWxlc1sndGFibGVfY2xvc2UnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGNvbnRleHQuY3VycmVudFNsaWRlLnRhYmxlcy5wdXNoKGNvbnRleHQudGFibGUpO1xuICAgIGNvbnRleHQuZW5kU3R5bGUoKTtcbn07XG5cbmZ1bGxUb2tlblJ1bGVzWyd0aGVhZF9vcGVuJ10gPSAoKSA9PiB7fTtcbmZ1bGxUb2tlblJ1bGVzWyd0aGVhZF9jbG9zZSddID0gKCkgPT4ge307XG5cbmZ1bGxUb2tlblJ1bGVzWyd0Ym9keV9vcGVuJ10gPSAoKSA9PiB7fTtcbmZ1bGxUb2tlblJ1bGVzWyd0Ym9keV9jbG9zZSddID0gKCkgPT4ge307XG5cbmZ1bGxUb2tlblJ1bGVzWyd0cl9vcGVuJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzdHlsZSA9IGFwcGx5VG9rZW5TdHlsZSh0b2tlbiwge30pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29udGV4dC5yb3cgPSBbXTtcbn07XG5cbmZ1bGxUb2tlblJ1bGVzWyd0cl9jbG9zZSddID0gKHRva2VuLCBjb250ZXh0KSA9PiB7XG4gICAgY29uc3Qgcm93ID0gY29udGV4dC5yb3c7XG4gICAgY29udGV4dC50YWJsZS5jZWxscy5wdXNoKHJvdyk7XG4gICAgY29udGV4dC50YWJsZS5jb2x1bW5zID0gTWF0aC5tYXgoY29udGV4dC50YWJsZS5jb2x1bW5zLCByb3cubGVuZ3RoKTtcbiAgICBjb250ZXh0LnRhYmxlLnJvd3MgPSBjb250ZXh0LnRhYmxlLmNlbGxzLmxlbmd0aDtcbiAgICBjb250ZXh0LmVuZFN0eWxlKCk7XG59O1xuXG5mdWxsVG9rZW5SdWxlc1sndGRfb3BlbiddID0gKHRva2VuLCBjb250ZXh0KSA9PiB7XG4gICAgY29uc3Qgc3R5bGUgPSBhcHBseVRva2VuU3R5bGUodG9rZW4sIHtcbiAgICAgICAgZm9yZWdyb3VuZENvbG9yOiB7XG4gICAgICAgICAgICBvcGFxdWVDb2xvcjoge1xuICAgICAgICAgICAgICAgIHRoZW1lQ29sb3I6ICdURVhUMScsXG4gICAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgIH0pO1xuICAgIGNvbnRleHQuc3RhcnRTdHlsZShzdHlsZSk7XG4gICAgY29udGV4dC5zdGFydFRleHRCbG9jaygpO1xufTtcblxuZnVsbFRva2VuUnVsZXNbJ3RoX29wZW4nXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IHN0eWxlID0gYXBwbHlUb2tlblN0eWxlKHRva2VuLCB7XG4gICAgICAgIGJvbGQ6IHRydWUsXG4gICAgICAgIC8vIE5vdGU6IE5vbi1wbGFjZWhvbGRlciBlbGVtZW50cyBhcmVuJ3QgYXdhcmUgb2YgdGhlIHNsaWRlIHRoZW1lLlxuICAgICAgICAvLyBTZXQgdGhlIGZvcmVncm91bmQgY29sb3IgdG8gbWF0Y2ggdGhlIHByaW1hcnkgdGV4dCBjb2xvciBvZiB0aGVcbiAgICAgICAgLy8gdGhlbWUuXG4gICAgICAgIGZvcmVncm91bmRDb2xvcjoge1xuICAgICAgICAgICAgb3BhcXVlQ29sb3I6IHtcbiAgICAgICAgICAgICAgICB0aGVtZUNvbG9yOiAnVEVYVDEnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICB9KTtcbiAgICBjb250ZXh0LnN0YXJ0U3R5bGUoc3R5bGUpO1xuICAgIGNvbnRleHQuc3RhcnRUZXh0QmxvY2soKTtcbn07XG5cbmZ1bGxUb2tlblJ1bGVzWyd0ZF9jbG9zZSddID0gZnVsbFRva2VuUnVsZXNbJ3RoX2Nsb3NlJ10gPSAodG9rZW4sIGNvbnRleHQpID0+IHtcbiAgICBjb250ZXh0LmVuZFN0eWxlKCk7XG4gICAgY29udGV4dC5yb3cucHVzaChjb250ZXh0LnRleHQpO1xuICAgIGNvbnRleHQuc3RhcnRUZXh0QmxvY2soKTtcbn07XG5cbmZ1bGxUb2tlblJ1bGVzWydnZW5lcmF0ZWRfaW1hZ2UnXSA9ICh0b2tlbiwgY29udGV4dCkgPT4ge1xuICAgIGNvbnN0IGltYWdlID0ge1xuICAgICAgICBzb3VyY2U6IHRva2VuLmNvbnRlbnQsXG4gICAgICAgIHR5cGU6IHRva2VuLmluZm8udHJpbSgpLFxuICAgICAgICB3aWR0aDogdW5kZWZpbmVkLFxuICAgICAgICBoZWlnaHQ6IHVuZGVmaW5lZCxcbiAgICAgICAgc3R5bGU6IGF0dHIodG9rZW4sICdzdHlsZScpLFxuICAgICAgICBwYWRkaW5nOiAwLFxuICAgICAgICBvZmZzZXRYOiAwLFxuICAgICAgICBvZmZzZXRZOiAwLFxuICAgIH07XG4gICAgY29uc3QgcGFkZGluZyA9IGF0dHIodG9rZW4sICdwYWQnKTtcbiAgICBpZiAocGFkZGluZykge1xuICAgICAgICBpbWFnZS5wYWRkaW5nID0gcGFyc2VJbnQocGFkZGluZyk7XG4gICAgfVxuICAgIGlmIChoYXNDbGFzcyh0b2tlbiwgJ2JhY2tncm91bmQnKSkge1xuICAgICAgICBjb250ZXh0LmN1cnJlbnRTbGlkZS5iYWNrZ3JvdW5kSW1hZ2UgPSBpbWFnZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZXh0LmltYWdlcy5wdXNoKGltYWdlKTtcbiAgICB9XG59O1xuXG4vKipcbiAqIFBhcnNlIHRoZSBtYXJrZG93biBhbmQgY29udmVydHMgaXQgaW50byBhIGZvcm0gbW9yZSBzdWl0YWJsZVxuICogZm9yIGNyZWF0aW5nIHNsaWRlcy5cbiAqXG4gKiBSZXR1cm5zIGFuIGFycmF5IG9mIG9iamVjdHMgd2hlcmUgZWFjaCBpdGVtIHJlcHJlc2VudHMgYW4gaW5kaXZpZHVhbFxuICogc2xpZGUuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1hcmtkb3duXG4gKiBAcGFyYW0ge3N0cmluZ30gc3R5bGVzaGVldFxuICogQHJldHVybnMge1Byb21pc2UuPEFycmF5Pn1cbiAqL1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZXh0cmFjdFNsaWRlcyhtYXJrZG93bjogc3RyaW5nLCBzdHlsZXNoZWV0OiBzdHJpbmcgPSBudWxsKTogU2xpZGVEZWZpbml0aW9uW10ge1xuICAgIGxldCB0b2tlbnMgPSBwYXJzZU1hcmtkb3duKG1hcmtkb3duKTtcbiAgICBsZXQgY3NzID0gcGFyc2VTdHlsZVNoZWV0KHN0eWxlc2hlZXQpO1xuICAgIGxldCBjb250ZXh0ID0gbmV3IENvbnRleHQoY3NzKTtcbiAgICBydWxlU2V0ID0gZnVsbFRva2VuUnVsZXM7IC8vIFRPRE8gLSBNYWtlIG5vdCBnbG9iYWxcbiAgICBwcm9jZXNzVG9rZW5zKHRva2VucywgY29udGV4dCk7XG4gICAgY29udGV4dC5kb25lKCk7XG4gICAgZGVidWcoJ1NsaWRlcyAlTycsIGNvbnRleHQuc2xpZGVzKTtcbiAgICByZXR1cm4gY29udGV4dC5zbGlkZXM7XG59XG4iXX0=
//# sourceMappingURL=extract_slides.js.map